!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t(require("@playkit-js/playkit-js"),require("shaka-player")):"function"==typeof define&&define.amd?define("dash",["playkit-js","shaka-player"],t):"object"==typeof exports?exports.dash=t(require("@playkit-js/playkit-js"),require("shaka-player")):(e.playkit=e.playkit||{},e.playkit.dash=t(e.playkit.core,e.shaka))}(window,(function(e,t){return function(e){var t={};function r(i){if(t[i])return t[i].exports;var n=t[i]={i:i,l:!1,exports:{}};return e[i].call(n.exports,n,n.exports,r),n.l=!0,n.exports}return r.m=e,r.c=t,r.d=function(e,t,i){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:i})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var i=Object.create(null);if(r.r(i),Object.defineProperty(i,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)r.d(i,n,function(t){return e[t]}.bind(null,n));return i},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="",r(r.s=6)}([function(t,r){t.exports=e},function(e,r){e.exports=t},function(e){e.exports=JSON.parse('{"shakaConfig":{"streaming":{"ignoreTextStreamFailures":true,"bufferingGoal":60,"alwaysStreamText":true},"abr":{"enabled":true,"restrictions":{}}},"forceRedirectExternalStreams":false,"trackEmsgEvents":true,"switchDynamicToStatic":false,"isStartOverType":false}')},function(e,t,r){(t=r(5)(!1)).push([e.i,".shaka-text-container {\n  position: absolute;\n  left: 0;\n  right: 0;\n  top: 0;\n  bottom: 0;\n  pointer-events: none;\n  width: 100%;\n  min-width: 48px;\n  transition: bottom cubic-bezier(0.4, 0, 0.6, 1) 0.1s;\n  transition-delay: 0s;\n  font-size: 20px;\n  line-height: 1.4;\n  color: #fff;\n  font-family: Roboto-Regular, Roboto, sans-serif, TengwarTelcontar;\n}\n.shaka-text-container span.shaka-text-wrapper {\n  display: inline;\n  background: 0 0;\n  text-align: center;\n}\n\n:fullscreen .shaka-text-container {\n  font-size: 4.4vmin;\n}\n\n:-webkit-full-screen .shaka-text-container {\n  font-size: 4.4vmin;\n}\n\n:-moz-full-screen .shaka-text-container {\n  font-size: 4.4vmin;\n}\n\n:-ms-fullscreen .shaka-text-container {\n  font-size: 4.4vmin;\n}\n",""]),e.exports=t},function(e,t,r){"use strict";var i,n=function(){return void 0===i&&(i=Boolean(window&&document&&document.all&&!window.atob)),i},a=function(){var e={};return function(t){if(void 0===e[t]){var r=document.querySelector(t);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(e){r=null}e[t]=r}return e[t]}}(),s=[];function o(e){for(var t=-1,r=0;r<s.length;r++)if(s[r].identifier===e){t=r;break}return t}function c(e,t){for(var r={},i=[],n=0;n<e.length;n++){var a=e[n],c=t.base?a[0]+t.base:a[0],u=r[c]||0,l="".concat(c," ").concat(u);r[c]=u+1;var h=o(l),d={css:a[1],media:a[2],sourceMap:a[3]};-1!==h?(s[h].references++,s[h].updater(d)):s.push({identifier:l,updater:_(d,t),references:1}),i.push(l)}return i}function u(e){var t=document.createElement("style"),i=e.attributes||{};if(void 0===i.nonce){var n=r.nc;n&&(i.nonce=n)}if(Object.keys(i).forEach((function(e){t.setAttribute(e,i[e])})),"function"==typeof e.insert)e.insert(t);else{var s=a(e.insert||"head");if(!s)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");s.appendChild(t)}return t}var l,h=(l=[],function(e,t){return l[e]=t,l.filter(Boolean).join("\n")});function d(e,t,r,i){var n=r?"":i.media?"@media ".concat(i.media," {").concat(i.css,"}"):i.css;if(e.styleSheet)e.styleSheet.cssText=h(t,n);else{var a=document.createTextNode(n),s=e.childNodes;s[t]&&e.removeChild(s[t]),s.length?e.insertBefore(a,s[t]):e.appendChild(a)}}function f(e,t,r){var i=r.css,n=r.media,a=r.sourceMap;if(n?e.setAttribute("media",n):e.removeAttribute("media"),a&&"undefined"!=typeof btoa&&(i+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(a))))," */")),e.styleSheet)e.styleSheet.cssText=i;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(i))}}var g=null,m=0;function _(e,t){var r,i,n;if(t.singleton){var a=m++;r=g||(g=u(t)),i=d.bind(null,r,a,!1),n=d.bind(null,r,a,!0)}else r=u(t),i=f.bind(null,r,t),n=function(){!function(e){if(null===e.parentNode)return!1;e.parentNode.removeChild(e)}(r)};return i(e),function(t){if(t){if(t.css===e.css&&t.media===e.media&&t.sourceMap===e.sourceMap)return;i(e=t)}else n()}}e.exports=function(e,t){(t=t||{}).singleton||"boolean"==typeof t.singleton||(t.singleton=n());var r=c(e=e||[],t);return function(e){if(e=e||[],"[object Array]"===Object.prototype.toString.call(e)){for(var i=0;i<r.length;i++){var n=o(r[i]);s[n].references--}for(var a=c(e,t),u=0;u<r.length;u++){var l=o(r[u]);0===s[l].references&&(s[l].updater(),s.splice(l,1))}r=a}}}},function(e,t,r){"use strict";e.exports=function(e){var t=[];return t.toString=function(){return this.map((function(t){var r=function(e,t){var r=e[1]||"",i=e[3];if(!i)return r;if(t&&"function"==typeof btoa){var n=(s=i,o=btoa(unescape(encodeURIComponent(JSON.stringify(s)))),c="sourceMappingURL=data:application/json;charset=utf-8;base64,".concat(o),"/*# ".concat(c," */")),a=i.sources.map((function(e){return"/*# sourceURL=".concat(i.sourceRoot||"").concat(e," */")}));return[r].concat(a).concat([n]).join("\n")}var s,o,c;return[r].join("\n")}(t,e);return t[2]?"@media ".concat(t[2]," {").concat(r,"}"):r})).join("")},t.i=function(e,r,i){"string"==typeof e&&(e=[[null,e,""]]);var n={};if(i)for(var a=0;a<this.length;a++){var s=this[a][0];null!=s&&(n[s]=!0)}for(var o=0;o<e.length;o++){var c=[].concat(e[o]);i&&n[c[0]]||(r&&(c[2]?c[2]="".concat(r," and ").concat(c[2]):c[2]=r),t.push(c))}},t}},function(e,t,r){"use strict";r.r(t),r.d(t,"VERSION",(function(){return X})),r.d(t,"NAME",(function(){return Z}));var i,n,a=r(0),s=r(1),o=r.n(s);var c,u,l,h,d,f=(n=i=function(){function e(){}return e.isConfigured=function(e,t){return a.DrmScheme.WIDEVINE===t.keySystem&&!!e.find((function(e){return e.scheme===t.keySystem}))},e.canPlayDrm=function(t){return e._logger.debug("Can play DRM scheme of: "+a.DrmScheme.WIDEVINE),!!t.find((function(e){return e.scheme===a.DrmScheme.WIDEVINE}))},e.setDrmPlayback=function(t,r){e._logger.debug("Sets drm playback");var i,n,s=a.Env.browser.name,o=r.find((function(e){return e.scheme===a.DrmScheme.WIDEVINE}));o&&(t.drm={servers:(i={},i[a.DrmScheme.WIDEVINE]=o.licenseUrl,i),advanced:{}},"Chrome"===s&&(t.drm.advanced=((n={})[a.DrmScheme.WIDEVINE]={videoRobustness:"SW_SECURE_CRYPTO",audioRobustness:"SW_SECURE_CRYPTO"},n)))},e}(),c=i,u="_logger",l=Object(a.getLogger)("Widevine"),u in c?Object.defineProperty(c,u,{value:l,enumerable:!0,configurable:!0,writable:!0}):c[u]=l,n);var g=(d=h=function(){function e(){}return e.isConfigured=function(e,t){return a.DrmScheme.PLAYREADY===t.keySystem&&!!e.find((function(e){return e.scheme===t.keySystem}))},e.canPlayDrm=function(t){return e._logger.debug("Can play DRM scheme of: "+a.DrmScheme.PLAYREADY),!!t.find((function(e){return e.scheme===a.DrmScheme.PLAYREADY}))},e.setDrmPlayback=function(t,r){e._logger.debug("Sets drm playback");var i,n=r.find((function(e){return e.scheme===a.DrmScheme.PLAYREADY}));n&&(t.drm={servers:(i={},i[a.DrmScheme.PLAYREADY]=n.licenseUrl,i)})},e}(),function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(h,"_logger",Object(a.getLogger)("PlayReady")),d),m=r(2),_=r(4),p=r.n(_),v=r(3),y=r.n(v),T={insert:"head",singleton:!1};p()(y.a,T),y.a.locals;function b(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var k=function(){function e(e){this._media=P.parseAttr(e,A.AttributeTypes.MEDIA),this._startNumber=P.parseAttr(e,A.AttributeTypes.START_NUMBER,P.parseInt,1),this._duration=P.parseAttr(e,A.AttributeTypes.DURATION,P.parseFloat),this._timescale=P.parseAttr(e,A.AttributeTypes.TIMESCALE,P.parsePositiveInt,1),this._presentationTimeOffset=P.parseAttr(e,A.AttributeTypes.PRESENTATION_TIME_OFFSET,P.parseInt,0),this._endNumber=P.parseAttr(e,A.AttributeTypes.END_NUMBER,P.parsePositiveInt)}var t,r,i;return t=e,(r=[{key:"media",get:function(){return this._media}},{key:"startNumber",get:function(){return this._startNumber}},{key:"duration",get:function(){return this._duration}},{key:"timescale",get:function(){return this._timescale}},{key:"presentationTimeOffset",get:function(){return this._presentationTimeOffset}},{key:"endNumber",get:function(){return this._endNumber}}])&&b(t.prototype,r),i&&b(t,i),e}();!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(k,"MediaTemplateType",{REPRESENTATION:"$RepresentationID$",NUMBER:"$Number$",BANDWIDTH:"$Bandwidth$",TIME:"$Time$"});var E=function(e,t){var r=t.id,i=t.index,n=t.bitrate,a=t.time,s=e.match(/\$([a-zA-Z]+)\$/g),o=function(e,t,r){return r?e.replace(t,r):e};return s&&s.forEach((function(t){switch(t){case k.MediaTemplateType.REPRESENTATION:e=o(e,t,r);break;case k.MediaTemplateType.NUMBER:e=o(e,t,i);break;case k.MediaTemplateType.BANDWIDTH:e=o(e,t,n);break;case k.MediaTemplateType.TIME:e=o(e,t,a)}})),e},S=function(e){return TextDecoder?(new TextDecoder).decode(new Uint8Array(e)):null},A={TagTypes:{BASE_URL:"BaseURL",SEGMENT_TEMPLATE:"SegmentTemplate",REPRESENTATION:"Representation",ESSENTIAL_PROPERTY:"EssentialProperty",ADAPTATION_SET:"AdaptationSet"},AttributeTypes:{BASE_URL:"BaseURL",ID:"id",CONTENT_TYPE:"contentType",MIME_TYPE:"mimeType",MEDIA:"media",DURATION:"duration",START_NUMBER:"startNumber",TIMESCALE:"timescale",PRESENTATION_TIME_OFFSET:"presentationTimeOffset",END_NUMBER:"endNumber",BANDWIDTH:"bandwidth",WIDTH:"width",HEIGHT:"height",SCHEME_ID_URI:"schemeIdUri",VALUE:"value"}},P={parseXml:function(e){return(new DOMParser).parseFromString(e,"text/xml")},parseAttr:function(e,t,r,i){var n=null,a=e.getAttribute(t);return null!==a&&(n=r?r(a):a),null==n?i:n},findElements:function(e,t){return e.getElementsByTagName(t)},findChild:function(e,t){var r=this.findChildren(e,t);return 1!==r.length?null:r[0]},findChildren:function(e,t){return Array.from(e.childNodes).filter((function(e){return e instanceof Element&&e.tagName===t}))},parseInt:function(e){var t=Number(e);return t%1==0?t:null},parsePositiveInt:function(e){var t=Number(e);return t%1==0&&t>0?t:null},parseFloat:function(e){var t=Number(e);return isNaN(t)?null:t}};function w(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var D=function(){function e(e){this._schemeIdUri=P.parseAttr(e,A.AttributeTypes.SCHEME_ID_URI),this._value=P.parseAttr(e,A.AttributeTypes.VALUE)}var t,r,i;return t=e,(r=[{key:"schemeIdUri",get:function(){return this._schemeIdUri}},{key:"value",get:function(){return this._value}}])&&w(t.prototype,r),i&&w(t,i),e}();function I(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var x=function(){function e(e){this._id=P.parseAttr(e,A.AttributeTypes.ID),this._bandwidth=P.parseAttr(e,A.AttributeTypes.BANDWIDTH,parseInt),this._width=P.parseAttr(e,A.AttributeTypes.WIDTH,parseInt),this._height=P.parseAttr(e,A.AttributeTypes.HEIGHT,parseInt);var t=P.findChild(e,A.TagTypes.ESSENTIAL_PROPERTY);t&&(this._essentialProperty=new D(t))}var t,r,i;return t=e,(r=[{key:"bandwidth",get:function(){return this._bandwidth}},{key:"id",get:function(){return this._id}},{key:"width",get:function(){return this._width}},{key:"height",get:function(){return this._height}},{key:"essentialProperty",get:function(){return this._essentialProperty}}])&&I(t.prototype,r),i&&I(t,i),e}();function O(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}var R=function(){function e(e){this._id=P.parseAttr(e,A.AttributeTypes.ID),this._mimeType=P.parseAttr(e,A.AttributeTypes.MIME_TYPE),this._contentType=P.parseAttr(e,A.AttributeTypes.CONTENT_TYPE),this._representations=Array.from(P.findChildren(e,A.TagTypes.REPRESENTATION)).map((function(e){return new x(e)}));var t=P.findChild(e,A.TagTypes.SEGMENT_TEMPLATE);t&&(this._segmentTemplate=new k(t));var r=P.findChild(e,A.TagTypes.ESSENTIAL_PROPERTY);r&&(this._essentialProperty=new D(r))}var t,r,i;return t=e,(r=[{key:"id",get:function(){return this._id}},{key:"mimeType",get:function(){return this._mimeType}},{key:"contentType",get:function(){return this._contentType}},{key:"segmentTemplate",get:function(){return this._segmentTemplate}},{key:"essentialProperty",get:function(){return this._essentialProperty}},{key:"representations",get:function(){return this._representations}}])&&O(t.prototype,r),i&&O(t,i),e}();function M(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function N(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}!function(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}(R,"ContentType",{VIDEO:"video",AUDIO:"audio",TEXT:"text",IMAGE:"image"});var C=function(){function e(e){var t,r=this;N(this,"_logger",Object(a.getLogger)("DashManifestParser")),N(this,"_parseAdaptionSets",(function(){var e=P.findElements(r._xmlDoc,A.TagTypes.BASE_URL);e&&e.length>0&&e[0].innerHTML&&(r._baseURL=e[0].textContent);var t=P.findElements(r._xmlDoc,A.TagTypes.ADAPTATION_SET),i=Array.from(t).filter((function(e){return P.parseAttr(e,A.AttributeTypes.CONTENT_TYPE)===R.ContentType.IMAGE}));i.length>0?(r._adaptationSets=i.map((function(e){return new R(e)})),r._logger.debug("Found image adaptation set",r._adaptationSets)):r._logger.debug("No image adaptations were found in manifest")})),this._logger.debug("Initialize manifest parser"),this._adaptationSets=[],(t=e instanceof ArrayBuffer?S(e):e)&&(this._xmlDoc=P.parseXml(t))}e.isValid=function(){return window.TextEncoder&&window.TextDecoder};var t,r,i,n=e.prototype;return n.parseManifest=function(){try{this._logger.debug("Start parsing dash manifest"),this._parseAdaptionSets(),this._logger.debug("Manifest parsing finished successfully")}catch(e){this._logger.warn("Manifest parsing failed",e)}},n.getBaseUrl=function(){return this._baseURL||""},n.getImageSet=function(){return this._adaptationSets.find((function(e){return e.contentType===R.ContentType.IMAGE}))},n.hasImageSet=function(){return!!this.getImageSet()},t=e,(r=[{key:"adaptationSets",get:function(){return this._adaptationSets}}])&&M(t.prototype,r),i&&M(t,i),e}();function L(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var U=function(){function e(e,t,r){var i=this;L(this,"_tracks",[]),L(this,"_parseTracks",(function(e,t,r){var n=e.representations,s=e.segmentTemplate,o=e.essentialProperty;n.forEach((function(e,n){var c=e.id,u=e.bandwidth,l=e.width,h=e.height,d=s.startNumber,f=s.duration,g=s.media,m=s.timescale,_=s.presentationTimeOffset,p=i._getEssentialValue(o,e),v=i._getDimensions(p),y=v[0],T=v[1];i._tracks.push(new a.ImageTrack({id:c,index:n,active:!1,width:l,height:h,duration:f,rows:y,cols:T,url:i._buildTemplateUrl(g,c,t,r),customData:{bitrate:u,startNumber:d,timescale:m,presentationTimeOffset:_}}))}))})),L(this,"_getDimensions",(function(e){var t=1,r=1;if(e.includes("x")){var i=e.split("x");r=parseInt(i[0]),t=parseInt(i[1])}return[t,r]})),L(this,"_getEssentialValue",(function(e,t){return e?e.value:t.essentialProperty?t.essentialProperty.value:""})),L(this,"_buildTemplateUrl",(function(e,t,r,i){var n=r.split("/").pop(),a=r.replace(n,"");return(i=i.replace(/^\.\/|^\./,"")).length>0&&!i.endsWith("/")&&(i+="/"),E(""+a+i+e,{id:t})})),L(this,"_buildUrlFromTemplate",(function(e,t){return E(e.url,{index:t,time:(t-1)*e.duration*e.customData.timescale,bitrate:e.customData.bitrate})})),this._parseTracks(e,t,r),this._tracks.length>0&&(this._tracks.sort((function(e,t){return e.customData.bitrate-t.customData.bitrate})),this.selectTrack(this._tracks[this._tracks.length-1]))}var t=e.prototype;return t.selectTrack=function(e){this._tracks.forEach((function(t){return t.index===e.index?t.active=!0:t.active=!1}))},t.getTracks=function(){return this._tracks},t.getActiveTrack=function(){return this._tracks.find((function(e){return e.active}))},t.getThumbnail=function(e){var t=this.getActiveTrack(),r=t.duration,i=t.rows,n=t.cols,s=t.sliceWidth,o=t.sliceHeight,c=t.customData,u=Math.floor(e/r)+c.startNumber,l=e%r,h=Math.floor(l*i*n/r);return new a.ThumbnailInfo({width:Math.floor(s),height:Math.floor(o),x:Math.floor(h%n)*s,y:Math.floor(h/n)*o,url:this._buildUrlFromTemplate(t,u)})},e}();function j(e,t,r,i,n,a,s){try{var o=e[a](s),c=o.value}catch(e){return void r(e)}o.done?t(c):Promise.resolve(c).then(i,n)}function B(e){return function(){var t=this,r=arguments;return new Promise((function(i,n){var a=e.apply(t,r);function s(e){j(a,i,n,s,o,"next",e)}function o(e){j(a,i,n,s,o,"throw",e)}s(void 0)}))}}function V(e,t){var r;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(r=function(e,t){if(!e)return;if("string"==typeof e)return F(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);"Object"===r&&e.constructor&&(r=e.constructor.name);if("Map"===r||"Set"===r)return Array.from(e);if("Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r))return F(e,t)}(e))||t&&e&&"number"==typeof e.length){r&&(e=r);var i=0;return function(){return i>=e.length?{done:!0}:{done:!1,value:e[i++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(r=e[Symbol.iterator]()).next.bind(r)}function F(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function H(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}function W(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function G(e,t,r){return t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r,e}var Y="error",q="adaptation",z="buffering",$="drmsessionupdate",K="emsg",J=function(e){var t,r;r=e,(t=u).prototype=Object.create(r.prototype),t.prototype.constructor=t,t.__proto__=r,u.createAdapter=function(e,t,r){var i=a.Utils.Object.copyDeep(m);if(a.Utils.Object.hasPropertyPath(r,"text.useNativeTextTrack")&&(i.textTrackVisibile=a.Utils.Object.getPropertyPath(r,"text.useNativeTextTrack")),a.Utils.Object.hasPropertyPath(r,"text.useShakaTextTrackDisplay")&&(i.useShakaTextTrackDisplay=a.Utils.Object.getPropertyPath(r,"text.useShakaTextTrackDisplay"),i.textTrackVisibile=i.textTrackVisibile||i.useShakaTextTrackDisplay),a.Utils.Object.hasPropertyPath(r,"streaming")){var n=r.streaming;"boolean"==typeof n.forceBreakStall&&(i.forceBreakStall=n.forceBreakStall),"boolean"==typeof n.lowLatencyMode&&(i.lowLatencyMode=n.lowLatencyMode),"boolean"==typeof n.trackEmsgEvents&&(i.trackEmsgEvents=n.trackEmsgEvents),"boolean"==typeof n.switchDynamicToStatic&&(i.switchDynamicToStatic=n.switchDynamicToStatic)}if(a.Utils.Object.hasPropertyPath(r,"sources.options")){var s=r.sources.options;i.forceRedirectExternalStreams=s.forceRedirectExternalStreams,i.redirectExternalStreamsHandler=s.redirectExternalStreamsHandler,i.redirectExternalStreamsTimeout=s.redirectExternalStreamsTimeout,s.isStartOverType&&(i.isStartOverType=!0)}if(a.Utils.Object.hasPropertyPath(r,"abr")){var o=r.abr;"boolean"==typeof o.enabled&&(i.shakaConfig.abr.enabled=o.enabled),"boolean"==typeof o.capLevelToPlayerSize&&(i.capLevelToPlayerSize=o.capLevelToPlayerSize),o.defaultBandwidthEstimate&&(i.shakaConfig.abr.defaultBandwidthEstimate=o.defaultBandwidthEstimate),o.restrictions&&a.Utils.Object.createPropertyPath(i,"abr.restrictions",o.restrictions)}return a.Utils.Object.hasPropertyPath(r,"playback.options.html5.dash")&&(a.Utils.Object.mergeDeep(i.shakaConfig,r.playback.options.html5.dash),a.Utils.Object.hasPropertyPath(i.shakaConfig,"manifest.dash.defaultPresentationDelay")&&(i.shakaConfig.manifest.defaultPresentationDelay=i.shakaConfig.manifest.dash.defaultPresentationDelay,delete i.shakaConfig.manifest.dash.defaultPresentationDelay)),i.network=r.network,new this(e,t,i)},u.canPlayType=function(e){var t="string"==typeof e&&(e.toLowerCase()===u._dashMimeType&&u.isMSESupported());return u._logger.debug("canPlayType result for mimeType: "+e+" is "+t.toString()),t};var i,n,s,c=u.prototype;function u(t,r,i){var n,s;return void 0===i&&(i={}),u._logger.debug("Creating adapter. Shaka version: "+o.a.Player.version),G(W(s=e.call(this,t,r,i)||this),"_shakaLib",o.a),G(W(s),"_adapterEventsBindings",((n={})[Y]=function(e){return s._onError(e)},n[q]=function(){return s._onAdaptation()},n[z]=function(e){return s._onBuffering(e)},n[$]=function(){return s._onDrmSessionUpdate()},n[K]=function(e){return s._onEmsg(e)},n[a.EventType.WAITING]=function(){return s._onWaiting()},n[a.EventType.PLAYING]=function(){return s._onPlaying()},n)),G(W(s),"_buffering",!1),G(W(s),"_waitingSent",!1),G(W(s),"_playingSent",!1),G(W(s),"_videoSizeUpdateTimer",null),G(W(s),"_stallInterval",null),G(W(s),"VIDEO_ERROR_CODE",3016),G(W(s),"_lastTimeDetach",NaN),G(W(s),"_requestFilterError",!1),G(W(s),"_responseFilterError",!1),G(W(s),"_isDestroyInProgress",!1),G(W(s),"_isStartOver",!0),G(W(s),"_seekRangeStart",0),G(W(s),"_isLive",!1),G(W(s),"_isStaticLive",!1),G(W(s),"_selectedVideoTrack",null),s._config=a.Utils.Object.mergeDeep({},m,s._config),s._init(),s}return c.setMaxBitrate=function(e){this._hasLowerOrEqualBitrate(e)&&this._shaka.configure({abr:{restrictions:{maxBandwidth:e}}})},c._getSortedTracks=function(){return this._shaka.getVariantTracks().map((function(e){return{id:e.id,bandwidth:e.bandwidth,active:e.active}})).sort((function(e,t){return e.bandwidth-t.bandwidth}))},c._hasLowerOrEqualBitrate=function(e){return this._getSortedTracks()[0].bandwidth<=e},u.canPlayDrm=function(e,t){u._availableDrmProtocol=[];for(var r,i=V(u._drmProtocols);!(r=i()).done;){var n=r.value;if(n.isConfigured(e,t)){u._availableDrmProtocol.push(n);break}}if(!u._availableDrmProtocol.length)for(var a,s=V(u._drmProtocols);!(a=s()).done;){var o=a.value;o.canPlayDrm(e)&&u._availableDrmProtocol.push(o)}return!!u._availableDrmProtocol.length},u.isSupported=function(){var e=!1;window.VTTCue||(e=!0),o.a.polyfill.installAll();var t=o.a.Player.isBrowserSupported();return e&&(window.VTTCue=void 0),u._logger.debug("isSupported:"+t),t},c._init=function(){o.a.polyfill.installAll(),this._shaka=new o.a.Player,this._config.useShakaTextTrackDisplay&&this._shaka.setVideoContainer(a.Utils.Dom.getElementBySelector(".playkit-subtitles")),this._maybeSetFilters(),this._maybeSetDrmConfig(),this._maybeBreakStalls(),this._shaka.configure(this._config.shakaConfig),this._addBindings()},c._clearStallInterval=function(){this._stallInterval&&(clearInterval(this._stallInterval),this._stallInterval=null)},c._stallHandler=function(){var e=this;this._clearStallInterval();var t=function(){return Date.now()/1e3},r=t(),i=this._videoElement.currentTime;this._stallInterval=setInterval((function(){t()-r>3&&!e._videoElement.paused&&(i===e._videoElement.currentTime&&(u._logger.debug("stall found, break the stall"),e._videoElement.currentTime=parseFloat(e._videoElement.currentTime.toFixed(1))+.1),e._clearStallInterval()),i=e._videoElement.currentTime}),500)},c._maybeBreakStalls=function(){var e=this;this._config.forceBreakStall&&this._eventManager.listen(this._videoElement,a.EventType.SEEKING,(function(){return e._stallHandler()}))},c._maybeGetRedirectedUrl=function(e){var t=this._config.forceRedirectExternalStreams,r=this._config.redirectExternalStreamsTimeout,i=this._config.redirectExternalStreamsHandler;return new Promise((function(n){if(!t)return n(e);a.Utils.Http.jsonp(e,i,{timeout:r}).then((function(e){n(e)})).catch((function(){return n(e)}))}))},c._maybeSetFilters=function(){var e=this;"function"==typeof a.Utils.Object.getPropertyPath(this._config,"network.requestFilter")&&(u._logger.debug("Register request filter"),this._shaka.getNetworkingEngine().registerRequestFilter((function(t,r){if(Object.values(a.RequestType).includes(t)){var i,n={url:r.uris[0],body:r.body,headers:r.headers};try{i=e._config.network.requestFilter(t,n)}catch(e){i=Promise.reject(e)}return(i=i||Promise.resolve(n)).then((function(e){r.uris=[e.url],r.headers=e.headers,"boolean"==typeof e.withCredentials&&(r.allowCrossSiteCredentials=e.withCredentials),"POST"===r.method?r.body=e.body:e.body&&u._logger.warn("Request with "+r.method+" method cannot have body")})).catch((function(t){throw e._requestFilterError=!0,t}))}}))),"function"==typeof a.Utils.Object.getPropertyPath(this._config,"network.responseFilter")&&(u._logger.debug("Register response filter"),this._shaka.getNetworkingEngine().registerResponseFilter((function(t,r){if(Object.values(a.RequestType).includes(t)){var i,n=r.uri,s=r.data,o=r.headers,c={url:n,originalUrl:e._sourceObj.url,data:s,headers:o};try{i=e._config.network.responseFilter(t,c)}catch(e){i=Promise.reject(e)}return(i=i||Promise.resolve(c)).then((function(e){r.data=e.data})).catch((function(t){throw e._responseFilterError=!0,t}))}})))},c._maybeSetDrmConfig=function(){if(this._sourceObj&&this._sourceObj.drmData)for(var e,t={},r=V(u._availableDrmProtocol);!(e=r()).done;){e.value.setDrmPlayback(t,this._sourceObj.drmData),this._config.shakaConfig.drm&&a.Utils.Object.mergeDeep(t.drm,this._config.shakaConfig.drm),a.Utils.Object.mergeDeep(this._config.shakaConfig,t)}},c._maybeCapLevelToPlayerSize=function(){var e=this;if(this._config.capLevelToPlayerSize){var t=function(){return{minHeight:0,maxHeight:e._videoHeight,minWidth:0,maxWidth:e._videoWidth,minBitrate:0,maxBitrate:1/0}};this._clearVideoUpdateTimer(),this._videoSizeUpdateTimer=setInterval((function(){return e._updateRestriction(t())}),1e3),this._updateRestriction(t())}},c._maybeApplyAbrRestrictions=function(){this._config.capLevelToPlayerSize||(this._clearVideoUpdateTimer(),a.Utils.Object.hasPropertyPath(this._config,"abr.restrictions")&&this._updateRestriction(this._config.abr.restrictions))},c._updateRestriction=function(e){var t=this._getRestrictionShakaConfig(e);this._shaka.configure({abr:{restrictions:t}})},c._getRestrictionShakaConfig=function(e){var t=this,r=function(e){var r=t._getVideoTracks();return Math.min.apply(null,r.map((function(t){return t[e]})))},i={};if(e){var n=e.maxHeight,a=e.maxWidth,s=e.maxBitrate,o=e.minHeight,c=e.minWidth,l=e.minBitrate,h=Math.max(o,0),d=Math.max(n,r("height"));d>=h?(i.minHeight=h,i.maxHeight=d):u._logger.warn("Invalid maxHeight restriction, maxHeight must be greater than minHeight",o,n);var f=Math.max(c,0),g=Math.max(a,r("width"));g>=f?(i.minWidth=f,i.maxWidth=g):u._logger.warn("Invalid maxWidth restriction, maxWidth must be greater than minWidth",c,a);var m=Math.max(l,0),_=Math.max(s,r("bandwidth"));_>=m?(i.minBandwidth=m,i.maxBandwidth=_):u._logger.warn("Invalid maxBitrate restriction, maxBitrate must be greater than minBitrate",l,s)}return i},c.attachMediaSource=function(){this._shaka||(this._videoElement&&this._videoElement.src&&(a.Utils.Dom.setAttribute(this._videoElement,"src",""),a.Utils.Dom.removeAttribute(this._videoElement,"src")),this._init())},c.detachMediaSource=function(){var e=this;return this._shaka?(0===Math.floor(this.duration-this.currentTime)?this._lastTimeDetach=0:this.currentTime>0&&(this._lastTimeDetach=this.currentTime),this._reset().then((function(){e._shaka=null,e._loadPromise=null}))):Promise.resolve()},c._clearVideoUpdateTimer=function(){this._videoSizeUpdateTimer&&(clearInterval(this._videoSizeUpdateTimer),this._videoSizeUpdateTimer=null)},c._addBindings=function(){var e=this;this._eventManager.listen(this._shaka,q,this._adapterEventsBindings.adaptation),this._eventManager.listen(this._shaka,Y,this._adapterEventsBindings.error),this._eventManager.listen(this._shaka,$,this._adapterEventsBindings.drmsessionupdate),this._eventManager.listen(this._videoElement,a.EventType.WAITING,this._adapterEventsBindings.waiting),this._eventManager.listen(this._videoElement,a.EventType.PLAYING,this._adapterEventsBindings.playing),this._eventManager.listen(this._videoElement,a.EventType.LOADED_DATA,(function(){return e._onLoadedData()})),this._eventManager.listenOnce(this._videoElement,a.EventType.PLAYING,(function(){e._eventManager.listen(e._shaka,z,e._adapterEventsBindings.buffering)})),this._config.trackEmsgEvents&&this._eventManager.listen(this._shaka,K,this._adapterEventsBindings.emsg),this._shaka.getNetworkingEngine().registerResponseFilter((function(t,r){switch(t){case o.a.net.NetworkingEngine.RequestType.SEGMENT:e._trigger(a.EventType.FRAG_LOADED,{miliSeconds:r.timeMs,bytes:r.data.byteLength,url:r.uri}),e.isLive()&&e._dispatchNativeEvent(a.EventType.DURATION_CHANGE);break;case o.a.net.NetworkingEngine.RequestType.MANIFEST:e._parseManifest(r.data),e._playbackActualUri=r.uri,e._trigger(a.EventType.MANIFEST_LOADED,{miliSeconds:r.timeMs}),setTimeout((function(){var t,i;e._isLive=e._isLive||(null==(t=e._shaka)?void 0:t.isLive()),e._isLive&&!(null==(i=e._shaka)?void 0:i.isLive())&&!e._isStaticLive&&e._config.switchDynamicToStatic&&(e._sourceObj.url=r.uri,e._switchFromDynamicToStatic())}))}}))},c._onLoadedData=function(){var e=this;this._setLowLatencyMode();var t=this.getSegmentDuration();this._seekRangeStart=this._shaka.seekRange().start,this._startOverTimeout=setTimeout((function(){e._shaka.seekRange().start-e._seekRangeStart>=t&&(e._isStartOver=!1)}),1e3*(t+1))},c._switchFromDynamicToStatic=function(){var e=B(regeneratorRuntime.mark((function e(){var t,r,i;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return u._logger.info("Switching from dynamic manifest to static"),this._dispatchNativeEvent(a.EventType.WAITING),t=this._videoElement.currentTime-this._seekRangeStart,r=this.isAdaptiveBitrateEnabled(),i=this._videoElement.paused,e.next=7,this.detachMediaSource();case 7:return this._isStaticLive=!0,this._isLive=!0,this.attachMediaSource(),e.next=12,this.load();case 12:this._videoElement.currentTime=t,i||this._videoElement.play(),r?this._onAdaptation():this._selectedVideoTrack&&this.selectVideoTrack(this._selectedVideoTrack);case 15:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}(),c._setLowLatencyMode=function(){this._shaka.configure({streaming:{lowLatencyMode:"boolean"==typeof this._config.lowLatencyMode?this._config.lowLatencyMode:this.isLive()}})},c._parseManifest=function(e){!this._manifestParser&&C.isValid()&&(u._logger.debug("Creating parser for the first time"),this._manifestParser=new C(e),this._manifestParser.parseManifest())},c.load=function(){var e=B(regeneratorRuntime.mark((function e(t){var r=this;return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this._loadPromise){e.next=5;break}return e.next=3,this._removeMediaKeys();case 3:this._shaka.attach(this._videoElement),this._loadPromise=new Promise((function(e,i){if(r._sourceObj&&r._sourceObj.url){r._trigger(a.EventType.ABR_MODE_CHANGED,{mode:r.isAdaptiveBitrateEnabled()?"auto":"manual"});var n=t&&t>-1?t:void 0;n=isNaN(r._lastTimeDetach)?n:r._lastTimeDetach,r._lastTimeDetach=NaN,r._maybeGetRedirectedUrl(r._sourceObj.url).then((function(e){return r._shaka.load(e,n)})).then((function(){var t={tracks:r._getParsedTracks()};r._maybeCapLevelToPlayerSize(),u._logger.debug("The source has been loaded successfully"),e(t)})).catch((function(e){i(new a.Error(r._isDestroyInProgress?a.Error.Severity.RECOVERABLE:e.severity,e.category,e.code,e.data))}))}}));case 5:return e.abrupt("return",this._loadPromise);case 6:case"end":return e.stop()}}),e,this)})));return function(t){return e.apply(this,arguments)}}(),c.destroy=function(){var t=this;return this._isDestroyInProgress=!0,new Promise((function(r,i){e.prototype.destroy.call(t).then((function(){u._logger.debug("destroy"),t._loadPromise=null,t._adapterEventsBindings={},t._reset().then((function(e){t._isDestroyInProgress=!1,r(e)})).catch((function(e){t._isDestroyInProgress=!1,i(e)}))}))}))},c.getThumbnail=function(e){if(this._thumbnailController)return this._thumbnailController.getThumbnail(e)},c._reset=function(){return this._buffering=!1,this._waitingSent=!1,this._playingSent=!1,this._isLive=!1,this._isStaticLive=!1,this._isStartOver=!0,this._requestFilterError=!1,this._responseFilterError=!1,this._manifestParser=null,this._thumbnailController=null,this._clearStallInterval(),this._clearVideoUpdateTimer(),clearTimeout(this._startOverTimeout),this._eventManager&&this._eventManager.removeAll(),this._shaka?this._shaka.destroy():Promise.resolve()},c._removeMediaKeys=function(){var e=B(regeneratorRuntime.mark((function e(){return regeneratorRuntime.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!this._videoElement||!this._videoElement.mediaKeys){e.next=16;break}return e.prev=1,u._logger.debug("Removing mediaKeys from the video element"),e.next=5,this._videoElement.setMediaKeys(null);case 5:u._logger.debug("mediaKeys removed"),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),this._logger.warn("mediaKeys not cleared");case 11:return e.prev=11,e.abrupt("return",Promise.resolve());case 14:e.next=17;break;case 16:return e.abrupt("return",Promise.resolve());case 17:case"end":return e.stop()}}),e,this,[[1,8,11,14]])})));return function(){return e.apply(this,arguments)}}(),c._getVideoTracks=function(){var e=this._shaka.getVariantTracks(),t=this._getActiveTrack();return e.filter((function(e){return e.audioId===t.audioId}))},c._getActiveTrack=function(){return this._shaka.getVariantTracks().find((function(e){return e.active}))},c._getAudioTracks=function(){var e=this._shaka.getVariantTracks(),t=this._shaka.getAudioLanguagesAndRoles();return t.forEach((function(t){var r=e.filter((function(e){return e.language===t.language})),i=r.map((function(e){return e.id})).join("_"),n=r.some((function(e){return e.active}));t.id=i,t.label=r[0].label,t.active=n})),t},c._getParsedTracks=function(){if(this._shaka){var e=this._getParsedVideoTracks(),t=this._getParsedAudioTracks(),r=this._getParsedTextTracks(),i=this._getParsedImageTracks();return e.concat(t).concat(r).concat(i)}return[]},c._getParsedVideoTracks=function(){var e=this._getVideoTracks(),t=[];if(e)for(var r=0;r<e.length;r++){var i={id:e[r].id,bandwidth:e[r].videoBandwidth||e[r].bandwidth,width:e[r].width,height:e[r].height,active:e[r].active,index:r};t.push(new a.VideoTrack(i))}return t},c._getParsedAudioTracks=function(){var e=this._getAudioTracks(),t=[];if(e)for(var r=0;r<e.length;r++){var i={id:e[r].id,active:e[r].active,label:e[r].label,language:e[r].language,index:r};t.push(new a.AudioTrack(i))}return t},c._getParsedTextTracks=function(){for(var e,t=[],r=V(this._shaka.getTextTracks());!(e=r()).done;){var i=e.value,n=i.kind?i.kind+"s":"";n=""===n&&this._config.useShakaTextTrackDisplay?"captions":n;var s={id:i.id,kind:n,active:!1,default:i.primary,label:i.label,language:i.language};t.push(new a.TextTrack(s))}return t},c._getParsedImageTracks=function(){var e,t,r=null==(e=this._manifestParser)?void 0:e.getImageSet(),i=(null==(t=this._manifestParser)?void 0:t.getBaseUrl())||"";return r?(this._thumbnailController=new U(r,this._playbackActualUri,i),this._thumbnailController.getTracks()):[]},c.selectVideoTrack=function(e){if(this._shaka){var t=this._getVideoTracks();if(e instanceof a.VideoTrack&&t){var r=t[e.index];r&&(this.isAdaptiveBitrateEnabled()&&(this._shaka.configure({abr:{enabled:!1}}),this._trigger(a.EventType.ABR_MODE_CHANGED,{mode:"manual"})),r.active||(this._selectedVideoTrack=e,this._shaka.selectVariantTrack(t[e.index],!0),this._onTrackChanged(e)))}}},c.selectAudioTrack=function(e){this._shaka&&e instanceof a.AudioTrack&&!e.active&&(this._shaka.selectAudioLanguage(e.language),this._onTrackChanged(e))},c.selectTextTrack=function(e){this._shaka&&e instanceof a.TextTrack&&!e.active&&("subtitles"===e.kind||"captions"===e.kind)&&(this._shaka.setTextTrackVisibility(this._config.textTrackVisibile),this._shaka.selectTextLanguage(e.language),this._onTrackChanged(e))},c.selectImageTrack=function(e){this._shaka&&this._thumbnailController&&e instanceof a.ImageTrack&&!e.active&&(this._thumbnailController.selectTrack(e),this._onTrackChanged(a.ImageTrack))},c.hideTextTrack=function(){this._shaka&&this._shaka.setTextTrackVisibility(!1)},c.enableAdaptiveBitrate=function(){this._shaka&&!this.isAdaptiveBitrateEnabled()&&(this._trigger(a.EventType.ABR_MODE_CHANGED,{mode:"auto"}),this._shaka.configure({abr:{enabled:!0}}))},c.isAdaptiveBitrateEnabled=function(){return!!this._shaka&&this._shaka.getConfiguration().abr.enabled},c.applyABRRestriction=function(e){if(a.Utils.Object.createPropertyPath(this._config,"abr.restrictions",e),this._maybeApplyAbrRestrictions(),!this.isAdaptiveBitrateEnabled()){var t=this._getParsedVideoTracks(),r=Object(a.filterTracksByRestriction)(t,this._config.abr.restrictions);if(r.length)r.find((function(e){return e.active}))||this.selectVideoTrack(r[0])}},c._getLiveEdge=function(){return this._shaka?this._shaka.seekRange().end:NaN},c.seekToLiveEdge=function(){this._shaka&&this._videoElement.readyState>0&&(this._videoElement.currentTime=this._getLiveEdge())},c.isLive=function(){var e;return(null==(e=this._shaka)?void 0:e.isLive())||this._isLive},c.isStartOver=function(){return this._config.isStartOverType||this._isStartOver},c.getSegmentDuration=function(){return this._shaka?this._shaka.getStats().maxSegmentDuration:0},c._onAdaptation=function(){var e=this._getParsedVideoTracks().find((function(e){return e.active}));this._onTrackChanged(e)},c._onError=function(e){if(e&&e.detail){var t=e.detail;if(t.code===this.VIDEO_ERROR_CODE)return;(this._requestFilterError||this._responseFilterError)&&t.data[0]instanceof o.a.util.Error&&(t=t.data[0],this._requestFilterError?this._requestFilterError=!1:this._responseFilterError=!1),this._trigger(a.EventType.ERROR,new a.Error(t.severity,t.category,t.code,t.data)),u._logger.error(t),t.severity===a.Error.Severity.CRITICAL&&this.destroy()}},c._onBuffering=function(e){e.buffering?this._waitingSent||(this._dispatchNativeEvent(a.EventType.WAITING),this._buffering=!0):(this._buffering=!1,this._videoElement.paused||this._playingSent||this._dispatchNativeEvent(a.EventType.PLAYING))},c._dispatchNativeEvent=function(e){var t;"function"==typeof window.Event?t=new Event(e):(t=document.createEvent("Event")).initEvent(e,!0,!0),this._videoElement.dispatchEvent(t)},c._onDrmSessionUpdate=function(){this._trigger(a.EventType.DRM_LICENSE_LOADED,{licenseTime:this._shaka.getStats().licenseTime,scheme:this._shaka.drmInfo().keySystem})},c._onEmsg=function(e){var t=e.detail,r=e.type,i=Array.from(this._videoElement.textTracks).find((function(e){return e.label===r}));i||(i=this._videoElement.addTextTrack(a.TextTrack.KIND.METADATA,r));var n=t.startTime,s=t.endTime,o=t.id,c=function(e,t){if(null==e)return{};var r,i,n={},a=Object.keys(e);for(i=0;i<a.length;i++)r=a[i],t.indexOf(r)>=0||(n[r]=e[r]);return n}(t,["startTime","endTime","id"]),u=new a.TimedMetadata(n,s,o,a.TimedMetadata.TYPE.EMSG,c),l=Object(a.createTextTrackCue)(u);i.addCue(l),this._trigger(a.EventType.TIMED_METADATA_ADDED,{cues:[u]})},c._onWaiting=function(){this._waitingSent=!0,this._playingSent=!1},c._onPlaying=function(){this._playingSent=!0,this._waitingSent=!1,this._buffering&&this._dispatchNativeEvent(a.EventType.WAITING)},c.getStartTimeOfDvrWindow=function(){return this.isLive()&&this._shaka?(this.isStartOver()?this._seekRangeStart:this._shaka.seekRange().start)+this._shaka.getConfiguration().streaming.safeSeekOffset:0},c.getDrmInfo=function(){var e=this._shaka.drmInfo();if(e){var t=e.licenseServerUri,r=e.keySystem,i=e.serverCertificateUri,n={licenseUrl:t,scheme:r};return i&&(n.certificate=i),n}return null},i=u,(n=[{key:"_videoWidth",get:function(){var e,t=this._videoElement;return t&&(e=t.width||t.clientWidth||t.offsetWidth,e*=this._contentScaleFactor),e}},{key:"_videoHeight",get:function(){var e,t=this._videoElement;return t&&(e=t.height||t.clientHeight||t.offsetHeight,e*=this._contentScaleFactor),e}},{key:"_contentScaleFactor",get:function(){var e=1;try{e=window.devicePixelRatio}catch(e){u._logger.debug("failed reading devicePixelRatio, assume 1")}return e}},{key:"liveDuration",get:function(){return this._getLiveEdge()}},{key:"targetBuffer",get:function(){var e=NaN;return this._shaka?(e=this.isLive()?this._getLiveEdge()-this._videoElement.currentTime:this._videoElement.duration-this._videoElement.currentTime,e=Math.min(e,this._shaka.getConfiguration().streaming.bufferingGoal+this._shaka.getStats().maxSegmentDuration)):NaN}}])&&H(i.prototype,n),s&&H(i,s),u}(a.BaseMediaSourceAdapter);G(J,"id","DashAdapter"),G(J,"_logger",a.BaseMediaSourceAdapter.getLogger(J.id)),G(J,"_dashMimeType","application/dash+xml"),G(J,"_drmProtocols",[f,g]),G(J,"_availableDrmProtocol",[]);var X="1.33.1",Z="@playkit-js/playkit-js-dash";t.default=J;J.isSupported()&&Object(a.registerMediaSourceAdapter)(J)}])}));
//# sourceMappingURL=playkit-dash.js.map