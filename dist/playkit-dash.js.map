{"version":3,"sources":["./dash/webpack/universalModuleDefinition","./dash/webpack/bootstrap","./dash/./assets/style.css","./dash/../node_modules/css-loader/dist/runtime/api.js","./dash/../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js","webpack://playkit.dash/./assets/style.css?703f","./dash/./dash-adapter.js","./dash/./dash-thumbnail-controller.js","./dash/./drm/playready.js","./dash/./drm/widevine.js","./dash/./index.js","./dash/./parser/adaptation-set.js","./dash/./parser/dash-manifest-parser.js","./dash/./parser/essential-property.js","./dash/./parser/parser-utils.js","./dash/./parser/representation.js","./dash/./parser/segment-template.js","./dash/external {\"commonjs\":\"@playkit-js/playkit-js\",\"commonjs2\":\"@playkit-js/playkit-js\",\"amd\":\"playkit-js\",\"root\":[\"playkit\",\"core\"]}","./dash/external {\"commonjs\":\"shaka-player\",\"commonjs2\":\"shaka-player\",\"amd\":\"shaka-player\",\"root\":\"shaka\"}"],"names":["ShakaEvent","ERROR","ADAPTATION","BUFFERING","DRM_SESSION_UPDATE","EMSG","ABR_RESTRICTION_UPDATE_INTERVAL","STALL_DETECTION_INTERVAL","STALL_DETECTION_THRESHOLD","STALL_BREAK_THRESHOLD","DashAdapter","createAdapter","videoElement","source","config","adapterConfig","Utils","Object","copyDeep","DefaultConfig","hasPropertyPath","textTrackVisibile","getPropertyPath","useShakaTextTrackDisplay","streaming","forceBreakStall","lowLatencyMode","trackEmsgEvents","options","sources","forceRedirectExternalStreams","redirectExternalStreamsHandler","redirectExternalStreamsTimeout","abr","enabled","shakaConfig","capLevelToPlayerSize","defaultBandwidthEstimate","restrictions","createPropertyPath","mergeDeep","playback","html5","dash","manifest","defaultPresentationDelay","network","canPlayType","mimeType","toLowerCase","_dashMimeType","isMSESupported","_logger","debug","toString","setMaxBitrate","bitrate","_hasLowerOrEqualBitrate","_shaka","configure","maxBandwidth","_getSortedTracks","tracks","getVariantTracks","sortedTracks","map","obj","id","bandwidth","active","sort","obj1","obj2","maxBitrate","canPlayDrm","drmData","drmConfig","_availableDrmProtocol","_drmProtocols","drmProtocol","isConfigured","push","length","isSupported","resetVttPolyfill","window","VTTCue","shaka","polyfill","installAll","Player","isBrowserSupported","undefined","version","event","_onError","_onAdaptation","_onBuffering","_onDrmSessionUpdate","_onEmsg","EventType","WAITING","_onWaiting","PLAYING","_onPlaying","NaN","_config","_init","setVideoContainer","Dom","getElementBySelector","_maybeSetFilters","_maybeSetDrmConfig","_maybeBreakStalls","_addBindings","_clearStallInterval","_stallInterval","clearInterval","_stallHandler","getCurrentTimeInSeconds","Date","now","lastUpdateTime","lastCurrentTime","_videoElement","currentTime","setInterval","stallSeconds","paused","parseFloat","toFixed","_eventManager","listen","SEEKING","_maybeGetRedirectedUrl","url","shouldRedirect","timeout","callback","Promise","resolve","Http","jsonp","then","uri","catch","getNetworkingEngine","registerRequestFilter","type","request","values","RequestType","includes","pkRequest","uris","body","headers","requestFilterPromise","requestFilter","error","reject","updatedRequest","withCredentials","allowCrossSiteCredentials","method","warn","_requestFilterError","registerResponseFilter","response","data","pkResponse","originalUrl","_sourceObj","responseFilterPromise","responseFilter","updatedResponse","_responseFilterError","setDrmPlayback","drm","_maybeCapLevelToPlayerSize","getRestrictions","minHeight","maxHeight","_videoHeight","minWidth","maxWidth","_videoWidth","minBitrate","Infinity","_clearVideoUpdateTimer","_videoSizeUpdateTimer","_updateRestriction","_maybeApplyAbrRestrictions","shakaRestrictionsConfig","_getRestrictionShakaConfig","getMinDimensions","dim","videoTracks","_getVideoTracks","Math","min","apply","variant","restrictionsShakaConfig","minHeightValue","max","maxHeightValue","minWidthValue","maxWidthValue","minBitrateValue","maxBitrateValue","minBandwidth","attachMediaSource","src","setAttribute","removeAttribute","detachMediaSource","floor","duration","_lastTimeDetach","_reset","_loadPromise","_adapterEventsBindings","adaptation","drmsessionupdate","waiting","playing","LOADED_DATA","_onLoadedData","listenOnce","buffering","emsg","net","NetworkingEngine","SEGMENT","_trigger","FRAG_LOADED","miliSeconds","timeMs","bytes","byteLength","isLive","_dispatchNativeEvent","DURATION_CHANGE","MANIFEST","_parseManifest","_playbackActualUri","MANIFEST_LOADED","setTimeout","_isLive","_isStaticLive","_switchFromDynamicToStatic","_setLowLatencyMode","segmentDuration","getSegmentDuration","_seekRangeStart","seekRange","start","_startOverTimeout","_isStartOver","distanceFromLive","_getLiveEdge","isAdaptiveBitrateEnabled","load","play","_selectedVideoTrack","selectVideoTrack","manifestBuffer","_manifestParser","DashManifestParser","isValid","parseManifest","startTime","_removeMediaKeys","attach","ABR_MODE_CHANGED","mode","shakaStartTime","isNaN","_getParsedTracks","Error","_isDestroyInProgress","Severity","RECOVERABLE","severity","category","code","destroy","resetResult","getThumbnail","time","_thumbnailController","_buffering","_waitingSent","_playingSent","clearTimeout","removeAll","mediaKeys","setMediaKeys","variantTracks","activeVariantTrack","_getActiveTrack","filter","variantTrack","audioId","find","_getAudioTracks","audioTracks","getAudioLanguagesAndRoles","forEach","track","sameLangAudioVariants","vt","language","join","some","label","_getParsedVideoTracks","_getParsedAudioTracks","textTracks","_getParsedTextTracks","imageTracks","_getParsedImageTracks","concat","parsedTracks","i","settings","videoBandwidth","width","height","index","VideoTrack","AudioTrack","getTextTracks","textTrack","kind","TextTrack","imageSet","getImageSet","mediaTemplatePrefix","getBaseUrl","DashThumbnailController","getTracks","videoTrack","selectedVideoTrack","selectVariantTrack","_onTrackChanged","selectAudioTrack","audioTrack","selectAudioLanguage","selectTextTrack","setTextTrackVisibility","selectTextLanguage","selectImageTrack","imageTrack","ImageTrack","selectTrack","hideTextTrack","enableAdaptiveBitrate","getConfiguration","applyABRRestriction","availableTracks","filterTracksByRestriction","activeTrackInRange","end","seekToLiveEdge","readyState","getStats","maxSegmentDuration","detail","VIDEO_ERROR_CODE","util","CRITICAL","Event","document","createEvent","initEvent","dispatchEvent","DRM_LICENSE_LOADED","licenseTime","scheme","drmInfo","keySystem","metadataTrack","Array","from","addTextTrack","KIND","METADATA","endTime","metadata","timedMetadata","TimedMetadata","TYPE","textTrackCue","createTextTrackCue","addCue","TIMED_METADATA_ADDED","cues","getStartTimeOfDvrWindow","safeSeekOffset","getDrmInfo","licenseServerUri","serverCertificateUri","drmDataObject","licenseUrl","certificate","clientWidth","offsetWidth","_contentScaleFactor","clientHeight","offsetHeight","pixelRatio","devicePixelRatio","e","targetBufferVal","bufferingGoal","BaseMediaSourceAdapter","getLogger","Widevine","PlayReady","set","playerUrl","representations","segmentTemplate","essentialProperty","representation","startNumber","media","timescale","presentationTimeOffset","value","_getEssentialValue","_getDimensions","rows","cols","_tracks","_buildTemplateUrl","customData","split","parseInt","mediaTemplate","last","pop","baseUrl","replace","regex","endsWith","urlTemplate","UrlUtils","_parseTracks","t1","t2","t","getActiveTrack","activeTrack","sliceWidth","sliceHeight","page","offset","thumbIndex","ThumbnailInfo","x","y","_buildUrlFromTemplate","DrmScheme","PLAYREADY","drmEntry","prDrmEntry","servers","WIDEVINE","browser","Env","name","wwDrmEntry","advanced","videoRobustness","audioRobustness","VERSION","__VERSION__","NAME","__NAME__","registerMediaSourceAdapter","AdaptationSet","elem","_id","XmlUtils","parseAttr","MpdUtils","AttributeTypes","ID","_mimeType","MIME_TYPE","_contentType","CONTENT_TYPE","_representations","findChildren","TagTypes","REPRESENTATION","repElem","Representation","segTempElem","findChild","SEGMENT_TEMPLATE","_segmentTemplate","SegmentTemplate","essPropElem","ESSENTIAL_PROPERTY","_essentialProperty","EssentialProperty","VIDEO","AUDIO","TEXT","IMAGE","TextEncoder","TextDecoder","baseURL","findElements","_xmlDoc","BASE_URL","innerHTML","_baseURL","textContent","adaptationNodes","ADAPTATION_SET","imageAdaptationsNodes","ContentType","_adaptationSets","xmlStr","ArrayBuffer","ParserUtils","BufferToStr","parseXml","_parseAdaptionSets","adaptationSet","contentType","hasImageSet","_schemeIdUri","SCHEME_ID_URI","_value","VALUE","regExp","expressions","match","replaceTokens","exp","token","MediaTemplateType","NUMBER","BANDWIDTH","TIME","buffer","textDecoder","decode","Uint8Array","StrToBuffer","str","textEncoder","encode","MEDIA","DURATION","START_NUMBER","TIMESCALE","PRESENTATION_TIME_OFFSET","END_NUMBER","WIDTH","HEIGHT","text","domParser","DOMParser","parseFromString","parseFunction","defaultValue","parsedValue","getAttribute","node","getElementsByTagName","children","childNodes","child","Element","tagName","intString","n","Number","parsePositiveInt","floatString","_bandwidth","_width","_height","_media","_startNumber","_duration","_timescale","_presentationTimeOffset","_endNumber"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,yCAAyC;AACzC,CAAC;AACD,O;QCVA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;;QAEA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;;;QAGA;QACA;;QAEA;QACA;;QAEA;QACA;QACA;QACA,0CAA0C,gCAAgC;QAC1E;QACA;;QAEA;QACA;QACA;QACA,wDAAwD,kBAAkB;QAC1E;QACA,iDAAiD,cAAc;QAC/D;;QAEA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA;QACA,yCAAyC,iCAAiC;QAC1E,gHAAgH,mBAAmB,EAAE;QACrI;QACA;;QAEA;QACA;QACA;QACA,2BAA2B,0BAA0B,EAAE;QACvD,iCAAiC,eAAe;QAChD;QACA;QACA;;QAEA;QACA,sDAAsD,+DAA+D;;QAErH;QACA;;;QAGA;QACA;;;;;;;;;;;;AClFA;AACA,kCAAkC,mBAAO,CAAC,yGAAmD;AAC7F;AACA;AACA,cAAc,QAAS,0BAA0B,uBAAuB,YAAY,aAAa,WAAW,cAAc,yBAAyB,gBAAgB,oBAAoB,yDAAyD,yBAAyB,oBAAoB,qBAAqB,gBAAgB,sEAAsE,GAAG,iDAAiD,oBAAoB,oBAAoB,uBAAuB,GAAG,uCAAuC,uBAAuB,GAAG,gDAAgD,uBAAuB,GAAG,6CAA6C,uBAAuB,GAAG,2CAA2C,uBAAuB,GAAG;AACrxB;AACA;;;;;;;;;;;;;ACNa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA,gBAAgB;;AAEhB;AACA;AACA;;AAEA;AACA,4CAA4C,qBAAqB;AACjE;;AAEA;AACA,KAAK;AACL,IAAI;AACJ;;;AAGA;AACA;AACA;AACA;AACA;;AAEA;;AAEA;AACA,qBAAqB,iBAAiB;AACtC;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA,oBAAoB,qBAAqB;AACzC;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA,8BAA8B;;AAE9B;;AAEA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA,KAAK;AACL;AACA;;AAEA;AACA,CAAC;;;AAGD;AACA;AACA;AACA,qDAAqD,cAAc;AACnE;AACA,C;;;;;;;;;;;;AC7Fa;;AAEb;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA,CAAC;;AAED;AACA;AACA;AACA;AACA,uDAAuD;;AAEvD;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA,CAAC;;AAED;;AAEA;AACA;;AAEA,iBAAiB,wBAAwB;AACzC;AACA;AACA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA,iBAAiB,iBAAiB;AAClC;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;AACA,OAAO;AACP;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;;AAEA;AACA,gBAAgB,KAAwC,GAAG,sBAAiB,GAAG,SAAI;;AAEnF;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;;AAEH;AACA;AACA,GAAG;AACH;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;;;AAGA;AACA;AACA;AACA;AACA;AACA;AACA,CAAC;;AAED;AACA,qEAAqE,qBAAqB,aAAa;;AAEvG;;AAEA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA;AACA;;AAEA;AACA;AACA,KAAK;AACL;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA,GAAG;AACH;AACA;;AAEA;AACA,yDAAyD;AACzD,GAAG;;AAEH;;;AAGA;AACA;AACA,GAAG;AACH;AACA;AACA;;AAEA;AACA;AACA;;AAEA;AACA;;AAEA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA,GAAG;AACH;AA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","file":"playkit-dash.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"@playkit-js/playkit-js\"), require(\"shaka-player\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine(\"dash\", [\"playkit-js\", \"shaka-player\"], factory);\n\telse if(typeof exports === 'object')\n\t\texports[\"dash\"] = factory(require(\"@playkit-js/playkit-js\"), require(\"shaka-player\"));\n\telse\n\t\troot[\"playkit\"] = root[\"playkit\"] || {}, root[\"playkit\"][\"dash\"] = factory(root[\"playkit\"][\"core\"], root[\"shaka\"]);\n})(window, function(__WEBPACK_EXTERNAL_MODULE__playkit_js_playkit_js__, __WEBPACK_EXTERNAL_MODULE_shaka_player__) {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./index.js\");\n","// Imports\nvar ___CSS_LOADER_API_IMPORT___ = require(\"../../node_modules/css-loader/dist/runtime/api.js\");\nexports = ___CSS_LOADER_API_IMPORT___(false);\n// Module\nexports.push([module.id, \".shaka-text-container {\\n  position: absolute;\\n  left: 0;\\n  right: 0;\\n  top: 0;\\n  bottom: 0;\\n  pointer-events: none;\\n  width: 100%;\\n  min-width: 48px;\\n  transition: bottom cubic-bezier(0.4, 0, 0.6, 1) 0.1s;\\n  transition-delay: 0s;\\n  font-size: 20px;\\n  line-height: 1.4;\\n  color: #fff;\\n  font-family: Roboto-Regular, Roboto, sans-serif, TengwarTelcontar;\\n}\\n.shaka-text-container span.shaka-text-wrapper {\\n  display: inline;\\n  background: 0 0;\\n  text-align: center;\\n}\\n\\n:fullscreen .shaka-text-container {\\n  font-size: 4.4vmin;\\n}\\n\\n:-webkit-full-screen .shaka-text-container {\\n  font-size: 4.4vmin;\\n}\\n\\n:-moz-full-screen .shaka-text-container {\\n  font-size: 4.4vmin;\\n}\\n\\n:-ms-fullscreen .shaka-text-container {\\n  font-size: 4.4vmin;\\n}\\n\", \"\"]);\n// Exports\nmodule.exports = exports;\n","\"use strict\";\n\n/*\n  MIT License http://www.opensource.org/licenses/mit-license.php\n  Author Tobias Koppers @sokra\n*/\n// css base code, injected by the css-loader\n// eslint-disable-next-line func-names\nmodule.exports = function (useSourceMap) {\n  var list = []; // return the list of modules as css string\n\n  list.toString = function toString() {\n    return this.map(function (item) {\n      var content = cssWithMappingToString(item, useSourceMap);\n\n      if (item[2]) {\n        return \"@media \".concat(item[2], \" {\").concat(content, \"}\");\n      }\n\n      return content;\n    }).join('');\n  }; // import a list of modules into the list\n  // eslint-disable-next-line func-names\n\n\n  list.i = function (modules, mediaQuery, dedupe) {\n    if (typeof modules === 'string') {\n      // eslint-disable-next-line no-param-reassign\n      modules = [[null, modules, '']];\n    }\n\n    var alreadyImportedModules = {};\n\n    if (dedupe) {\n      for (var i = 0; i < this.length; i++) {\n        // eslint-disable-next-line prefer-destructuring\n        var id = this[i][0];\n\n        if (id != null) {\n          alreadyImportedModules[id] = true;\n        }\n      }\n    }\n\n    for (var _i = 0; _i < modules.length; _i++) {\n      var item = [].concat(modules[_i]);\n\n      if (dedupe && alreadyImportedModules[item[0]]) {\n        // eslint-disable-next-line no-continue\n        continue;\n      }\n\n      if (mediaQuery) {\n        if (!item[2]) {\n          item[2] = mediaQuery;\n        } else {\n          item[2] = \"\".concat(mediaQuery, \" and \").concat(item[2]);\n        }\n      }\n\n      list.push(item);\n    }\n  };\n\n  return list;\n};\n\nfunction cssWithMappingToString(item, useSourceMap) {\n  var content = item[1] || ''; // eslint-disable-next-line prefer-destructuring\n\n  var cssMapping = item[3];\n\n  if (!cssMapping) {\n    return content;\n  }\n\n  if (useSourceMap && typeof btoa === 'function') {\n    var sourceMapping = toComment(cssMapping);\n    var sourceURLs = cssMapping.sources.map(function (source) {\n      return \"/*# sourceURL=\".concat(cssMapping.sourceRoot || '').concat(source, \" */\");\n    });\n    return [content].concat(sourceURLs).concat([sourceMapping]).join('\\n');\n  }\n\n  return [content].join('\\n');\n} // Adapted from convert-source-map (MIT)\n\n\nfunction toComment(sourceMap) {\n  // eslint-disable-next-line no-undef\n  var base64 = btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap))));\n  var data = \"sourceMappingURL=data:application/json;charset=utf-8;base64,\".concat(base64);\n  return \"/*# \".concat(data, \" */\");\n}","\"use strict\";\n\nvar isOldIE = function isOldIE() {\n  var memo;\n  return function memorize() {\n    if (typeof memo === 'undefined') {\n      // Test for IE <= 9 as proposed by Browserhacks\n      // @see http://browserhacks.com/#hack-e71d8692f65334173fee715c222cb805\n      // Tests for existence of standard globals is to allow style-loader\n      // to operate correctly into non-standard environments\n      // @see https://github.com/webpack-contrib/style-loader/issues/177\n      memo = Boolean(window && document && document.all && !window.atob);\n    }\n\n    return memo;\n  };\n}();\n\nvar getTarget = function getTarget() {\n  var memo = {};\n  return function memorize(target) {\n    if (typeof memo[target] === 'undefined') {\n      var styleTarget = document.querySelector(target); // Special case to return head of iframe instead of iframe itself\n\n      if (window.HTMLIFrameElement && styleTarget instanceof window.HTMLIFrameElement) {\n        try {\n          // This will throw an exception if access to iframe is blocked\n          // due to cross-origin restrictions\n          styleTarget = styleTarget.contentDocument.head;\n        } catch (e) {\n          // istanbul ignore next\n          styleTarget = null;\n        }\n      }\n\n      memo[target] = styleTarget;\n    }\n\n    return memo[target];\n  };\n}();\n\nvar stylesInDom = [];\n\nfunction getIndexByIdentifier(identifier) {\n  var result = -1;\n\n  for (var i = 0; i < stylesInDom.length; i++) {\n    if (stylesInDom[i].identifier === identifier) {\n      result = i;\n      break;\n    }\n  }\n\n  return result;\n}\n\nfunction modulesToDom(list, options) {\n  var idCountMap = {};\n  var identifiers = [];\n\n  for (var i = 0; i < list.length; i++) {\n    var item = list[i];\n    var id = options.base ? item[0] + options.base : item[0];\n    var count = idCountMap[id] || 0;\n    var identifier = \"\".concat(id, \" \").concat(count);\n    idCountMap[id] = count + 1;\n    var index = getIndexByIdentifier(identifier);\n    var obj = {\n      css: item[1],\n      media: item[2],\n      sourceMap: item[3]\n    };\n\n    if (index !== -1) {\n      stylesInDom[index].references++;\n      stylesInDom[index].updater(obj);\n    } else {\n      stylesInDom.push({\n        identifier: identifier,\n        updater: addStyle(obj, options),\n        references: 1\n      });\n    }\n\n    identifiers.push(identifier);\n  }\n\n  return identifiers;\n}\n\nfunction insertStyleElement(options) {\n  var style = document.createElement('style');\n  var attributes = options.attributes || {};\n\n  if (typeof attributes.nonce === 'undefined') {\n    var nonce = typeof __webpack_nonce__ !== 'undefined' ? __webpack_nonce__ : null;\n\n    if (nonce) {\n      attributes.nonce = nonce;\n    }\n  }\n\n  Object.keys(attributes).forEach(function (key) {\n    style.setAttribute(key, attributes[key]);\n  });\n\n  if (typeof options.insert === 'function') {\n    options.insert(style);\n  } else {\n    var target = getTarget(options.insert || 'head');\n\n    if (!target) {\n      throw new Error(\"Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.\");\n    }\n\n    target.appendChild(style);\n  }\n\n  return style;\n}\n\nfunction removeStyleElement(style) {\n  // istanbul ignore if\n  if (style.parentNode === null) {\n    return false;\n  }\n\n  style.parentNode.removeChild(style);\n}\n/* istanbul ignore next  */\n\n\nvar replaceText = function replaceText() {\n  var textStore = [];\n  return function replace(index, replacement) {\n    textStore[index] = replacement;\n    return textStore.filter(Boolean).join('\\n');\n  };\n}();\n\nfunction applyToSingletonTag(style, index, remove, obj) {\n  var css = remove ? '' : obj.media ? \"@media \".concat(obj.media, \" {\").concat(obj.css, \"}\") : obj.css; // For old IE\n\n  /* istanbul ignore if  */\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = replaceText(index, css);\n  } else {\n    var cssNode = document.createTextNode(css);\n    var childNodes = style.childNodes;\n\n    if (childNodes[index]) {\n      style.removeChild(childNodes[index]);\n    }\n\n    if (childNodes.length) {\n      style.insertBefore(cssNode, childNodes[index]);\n    } else {\n      style.appendChild(cssNode);\n    }\n  }\n}\n\nfunction applyToTag(style, options, obj) {\n  var css = obj.css;\n  var media = obj.media;\n  var sourceMap = obj.sourceMap;\n\n  if (media) {\n    style.setAttribute('media', media);\n  } else {\n    style.removeAttribute('media');\n  }\n\n  if (sourceMap && typeof btoa !== 'undefined') {\n    css += \"\\n/*# sourceMappingURL=data:application/json;base64,\".concat(btoa(unescape(encodeURIComponent(JSON.stringify(sourceMap)))), \" */\");\n  } // For old IE\n\n  /* istanbul ignore if  */\n\n\n  if (style.styleSheet) {\n    style.styleSheet.cssText = css;\n  } else {\n    while (style.firstChild) {\n      style.removeChild(style.firstChild);\n    }\n\n    style.appendChild(document.createTextNode(css));\n  }\n}\n\nvar singleton = null;\nvar singletonCounter = 0;\n\nfunction addStyle(obj, options) {\n  var style;\n  var update;\n  var remove;\n\n  if (options.singleton) {\n    var styleIndex = singletonCounter++;\n    style = singleton || (singleton = insertStyleElement(options));\n    update = applyToSingletonTag.bind(null, style, styleIndex, false);\n    remove = applyToSingletonTag.bind(null, style, styleIndex, true);\n  } else {\n    style = insertStyleElement(options);\n    update = applyToTag.bind(null, style, options);\n\n    remove = function remove() {\n      removeStyleElement(style);\n    };\n  }\n\n  update(obj);\n  return function updateStyle(newObj) {\n    if (newObj) {\n      if (newObj.css === obj.css && newObj.media === obj.media && newObj.sourceMap === obj.sourceMap) {\n        return;\n      }\n\n      update(obj = newObj);\n    } else {\n      remove();\n    }\n  };\n}\n\nmodule.exports = function (list, options) {\n  options = options || {}; // Force single-tag solution on IE6-9, which has a hard limit on the # of <style>\n  // tags it will allow on a page\n\n  if (!options.singleton && typeof options.singleton !== 'boolean') {\n    options.singleton = isOldIE();\n  }\n\n  list = list || [];\n  var lastIdentifiers = modulesToDom(list, options);\n  return function update(newList) {\n    newList = newList || [];\n\n    if (Object.prototype.toString.call(newList) !== '[object Array]') {\n      return;\n    }\n\n    for (var i = 0; i < lastIdentifiers.length; i++) {\n      var identifier = lastIdentifiers[i];\n      var index = getIndexByIdentifier(identifier);\n      stylesInDom[index].references--;\n    }\n\n    var newLastIdentifiers = modulesToDom(newList, options);\n\n    for (var _i = 0; _i < lastIdentifiers.length; _i++) {\n      var _identifier = lastIdentifiers[_i];\n\n      var _index = getIndexByIdentifier(_identifier);\n\n      if (stylesInDom[_index].references === 0) {\n        stylesInDom[_index].updater();\n\n        stylesInDom.splice(_index, 1);\n      }\n    }\n\n    lastIdentifiers = newLastIdentifiers;\n  };\n};","import api from \"!../../node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js\";\n            import content from \"!!../../node_modules/css-loader/dist/cjs.js!./style.css\";\n\nvar options = {};\n\noptions.insert = \"head\";\noptions.singleton = false;\n\nvar update = api(content, options);\n\n\n\nexport default content.locals || {};","// @flow\nimport shaka from 'shaka-player';\nimport {\n  AudioTrack,\n  BaseMediaSourceAdapter,\n  Error,\n  EventType,\n  RequestType,\n  TextTrack,\n  Track,\n  TimedMetadata,\n  createTextTrackCue,\n  Utils,\n  VideoTrack,\n  ImageTrack,\n  ThumbnailInfo,\n  PKABRRestrictionObject,\n  filterTracksByRestriction\n} from '@playkit-js/playkit-js';\nimport {Widevine} from './drm/widevine';\nimport {PlayReady} from './drm/playready';\nimport DefaultConfig from './default-config';\nimport './assets/style.css';\nimport {DashManifestParser} from './parser/dash-manifest-parser';\nimport {DashThumbnailController} from './dash-thumbnail-controller';\n\ntype ShakaEventType = {[event: string]: string};\n\n/**\n * Shaka events enum\n * @type {Object}\n * @const\n */\nconst ShakaEvent: ShakaEventType = {\n  ERROR: 'error',\n  ADAPTATION: 'adaptation',\n  BUFFERING: 'buffering',\n  DRM_SESSION_UPDATE: 'drmsessionupdate',\n  EMSG: 'emsg'\n};\n\n/**\n * the interval in which to sample player size changes\n * @type {number}\n * @const\n */\nconst ABR_RESTRICTION_UPDATE_INTERVAL = 1000;\n\n/**\n * the interval for stall detection in milliseconds\n * @type {number}\n * @const\n */\nconst STALL_DETECTION_INTERVAL = 500;\n\n/**\n * the threshold for stall detection in seconds\n * @type {number}\n * @const\n */\nconst STALL_DETECTION_THRESHOLD = 3;\n\n/**\n * the threshold needed to break the stall\n * @type {number}\n * @const\n */\nconst STALL_BREAK_THRESHOLD = 0.1;\n\n/**\n * Adapter of shaka lib for dash content\n * @classdesc\n */\nexport default class DashAdapter extends BaseMediaSourceAdapter {\n  /**\n   * The id of Adapter\n   * @member {string} id\n   * @static\n   * @public\n   */\n  static id = 'DashAdapter';\n  /**\n   * The adapter logger\n   * @member {any} _logger\n   * @private\n   * @static\n   */\n  static _logger = BaseMediaSourceAdapter.getLogger(DashAdapter.id);\n  /**\n   * The supported mime type by the dash adapter\n   * @member {string} _dashMimeType\n   * @static\n   * @private\n   */\n  static _dashMimeType = 'application/dash+xml';\n  /**\n   * The DRM protocols implementations for dash adapter.\n   * @type {Array<Function>}\n   * @private\n   * @static\n   */\n  static _drmProtocols: Array<Function> = [Widevine, PlayReady];\n  /**\n   * The DRM protocols available for the current playback.\n   * @type {Array<Function>}\n   * @private\n   * @static\n   */\n  static _availableDrmProtocol: Array<Function> = [];\n  /**\n   * The shaka Lib\n   * @member {any} _shakaLib\n   * @private\n   */\n  _shakaLib: any = shaka;\n  /**\n   * The shaka player instance\n   * @member {any} _shaka\n   * @private\n   */\n  _shaka: any;\n  /**\n   * an object containing all the events we bind and unbind to.\n   * @member {Object} - _adapterEventsBindings\n   * @type {Object}\n   * @private\n   */\n  _adapterEventsBindings: {[name: string]: Function} = {\n    [ShakaEvent.ERROR]: event => this._onError(event),\n    [ShakaEvent.ADAPTATION]: () => this._onAdaptation(),\n    [ShakaEvent.BUFFERING]: event => this._onBuffering(event),\n    [ShakaEvent.DRM_SESSION_UPDATE]: () => this._onDrmSessionUpdate(),\n    [ShakaEvent.EMSG]: event => this._onEmsg(event),\n    [EventType.WAITING]: () => this._onWaiting(),\n    [EventType.PLAYING]: () => this._onPlaying()\n  };\n  /**\n   * The load promise\n   * @member {Promise<Object>} - _loadPromise\n   * @type {Promise<Object>}\n   * @private\n   */\n  _loadPromise: ?Promise<Object>;\n  /**\n   * The buffering state flag\n   * @member {boolean} - _buffering\n   * @type {boolean}\n   * @private\n   */\n  _buffering: boolean = false;\n  /**\n   * Whether 'waiting' event has been sent by the HTMLVideoElement\n   * @member {boolean} - _waitingSent\n   * @type {boolean}\n   * @private\n   */\n  _waitingSent: boolean = false;\n  /**\n   * Whether 'playing' event has been sent by the HTMLVideoElement\n   * @member {boolean} - _playingSent\n   * @type {boolean}\n   * @private\n   */\n  _playingSent: boolean = false;\n\n  /**\n   * Video size update timer\n   * @type {null|number}\n   * @private\n   */\n  _videoSizeUpdateTimer: ?IntervalID = null;\n\n  /**\n   * stall interval to break the stall on Smart TV\n   * @type {null|IntervalID}\n   * @private\n   */\n  _stallInterval: ?IntervalID = null;\n\n  /**\n   * 3016 is the number of the video error at shaka, we already listens to it in the html5 class\n   * @member {number} - VIDEO_ERROR_CODE\n   * @type {number}\n   * @private\n   */\n  VIDEO_ERROR_CODE: number = 3016;\n  /**\n   * The last time detach occurred\n   * @type {number}\n   * @private\n   */\n  _lastTimeDetach: number = NaN;\n  /**\n   * Whether the request filter threw an error\n   * @type {boolean}\n   * @private\n   */\n  _requestFilterError: boolean = false;\n  /**\n   * Whether the response filter threw an error\n   * @type {boolean}\n   * @private\n   */\n  _responseFilterError: boolean = false;\n  /**\n   * Whether async destroy is in progress\n   * @type {boolean}\n   * @private\n   */\n  _isDestroyInProgress: boolean = false;\n  /**\n   * Custom dash manifest parser.\n   * @type {DashManifestParser}\n   * @private\n   */\n  _manifestParser: ?DashManifestParser;\n  /**\n   * Dash thumbnail controller.\n   * @type {DashThumbnailController}\n   * @private\n   */\n  _thumbnailController: ?DashThumbnailController;\n  _isStartOver: boolean = true;\n  _seekRangeStart: number = 0;\n  _startOverTimeout: TimeoutID;\n  _isLive: boolean = false;\n  _isStaticLive: boolean = false;\n  _selectedVideoTrack: ?VideoTrack = null;\n\n  /**\n   * Factory method to create media source adapter.\n   * @function createAdapter\n   * @param {HTMLVideoElement} videoElement - The video element that the media source adapter work with.\n   * @param {PKMediaSourceObject} source - The source Object.\n   * @param {Object} config - The player configuration.\n   * @returns {IMediaSourceAdapter} - New instance of the run time media source adapter.\n   * @static\n   */\n  static createAdapter(videoElement: HTMLVideoElement, source: PKMediaSourceObject, config: Object): IMediaSourceAdapter {\n    let adapterConfig: Object = Utils.Object.copyDeep(DefaultConfig);\n    if (Utils.Object.hasPropertyPath(config, 'text.useNativeTextTrack')) {\n      adapterConfig.textTrackVisibile = Utils.Object.getPropertyPath(config, 'text.useNativeTextTrack');\n    }\n    if (Utils.Object.hasPropertyPath(config, 'text.useShakaTextTrackDisplay')) {\n      adapterConfig.useShakaTextTrackDisplay = Utils.Object.getPropertyPath(config, 'text.useShakaTextTrackDisplay');\n    }\n    if (Utils.Object.hasPropertyPath(config, 'streaming')) {\n      const {streaming} = config;\n      if (typeof streaming.forceBreakStall === 'boolean') {\n        adapterConfig.forceBreakStall = streaming.forceBreakStall;\n      }\n      if (typeof streaming.lowLatencyMode === 'boolean') {\n        adapterConfig.lowLatencyMode = streaming.lowLatencyMode;\n      }\n      if (typeof streaming.trackEmsgEvents === 'boolean') {\n        adapterConfig.trackEmsgEvents = streaming.trackEmsgEvents;\n      }\n    }\n    if (Utils.Object.hasPropertyPath(config, 'sources.options')) {\n      const options = config.sources.options;\n      adapterConfig.forceRedirectExternalStreams = options.forceRedirectExternalStreams;\n      adapterConfig.redirectExternalStreamsHandler = options.redirectExternalStreamsHandler;\n      adapterConfig.redirectExternalStreamsTimeout = options.redirectExternalStreamsTimeout;\n    }\n    if (Utils.Object.hasPropertyPath(config, 'abr')) {\n      const abr = config.abr;\n      if (typeof abr.enabled === 'boolean') {\n        adapterConfig.shakaConfig.abr.enabled = abr.enabled;\n      }\n      if (typeof abr.capLevelToPlayerSize === 'boolean') {\n        adapterConfig.capLevelToPlayerSize = abr.capLevelToPlayerSize;\n      }\n      if (abr.defaultBandwidthEstimate) {\n        adapterConfig.shakaConfig.abr.defaultBandwidthEstimate = abr.defaultBandwidthEstimate;\n      }\n      if (abr.restrictions) {\n        Utils.Object.createPropertyPath(adapterConfig, 'abr.restrictions', abr.restrictions);\n      }\n    }\n\n    //Merge shaka config with override config, override takes precedence\n    if (Utils.Object.hasPropertyPath(config, 'playback.options.html5.dash')) {\n      Utils.Object.mergeDeep(adapterConfig.shakaConfig, config.playback.options.html5.dash);\n\n      //for backward compatibility with shaka version < 4\n      if (Utils.Object.hasPropertyPath(adapterConfig.shakaConfig, 'manifest.dash.defaultPresentationDelay')) {\n        adapterConfig.shakaConfig.manifest.defaultPresentationDelay = adapterConfig.shakaConfig.manifest.dash.defaultPresentationDelay;\n        delete adapterConfig.shakaConfig.manifest.dash.defaultPresentationDelay;\n      }\n    }\n    adapterConfig.network = config.network;\n    return new this(videoElement, source, adapterConfig);\n  }\n\n  /**\n   * Checks if dash adapter can play a given mime type\n   * @function canPlayType\n   * @param {string} mimeType - The mime type to check\n   * @returns {boolean} - Whether the dash adapter can play a specific mime type\n   * @static\n   */\n  static canPlayType(mimeType: string): boolean {\n    let canPlayType = typeof mimeType === 'string' ? mimeType.toLowerCase() === DashAdapter._dashMimeType && DashAdapter.isMSESupported() : false;\n    DashAdapter._logger.debug('canPlayType result for mimeType: ' + mimeType + ' is ' + canPlayType.toString());\n    return canPlayType;\n  }\n\n  /**\n   * set 'bitrate' the max bandwidth (if possible)\n   * @param {number} bitrate the max bitrate allowed\n   * @returns {void}\n   */\n  setMaxBitrate(bitrate: number): void {\n    if (this._hasLowerOrEqualBitrate(bitrate)) {\n      this._shaka.configure({abr: {restrictions: {maxBandwidth: bitrate}}});\n    }\n  }\n\n  _getSortedTracks(): Array<Object> {\n    const tracks = this._shaka.getVariantTracks();\n    const sortedTracks = tracks\n      .map(obj => ({\n        id: obj.id,\n        bandwidth: obj.bandwidth,\n        active: obj.active\n      }))\n      .sort((obj1, obj2) => obj1.bandwidth - obj2.bandwidth);\n    return sortedTracks;\n  }\n\n  _hasLowerOrEqualBitrate(maxBitrate: number): boolean {\n    const sortedTracks = this._getSortedTracks();\n    if (sortedTracks[0].bandwidth <= maxBitrate) {\n      return true;\n    }\n    return false;\n  }\n\n  /**\n   * Checks if dash adapter can play a given drm data.\n   * @param {Array<Object>} drmData - The drm data to check.\n   * @param {PKDrmConfigObject} drmConfig - The drm config.\n   * @returns {boolean} - Whether the dash adapter can play a specific drm data.\n   * @static\n   */\n  static canPlayDrm(drmData: Array<Object>, drmConfig: PKDrmConfigObject): boolean {\n    DashAdapter._availableDrmProtocol = [];\n    for (let drmProtocol of DashAdapter._drmProtocols) {\n      if (drmProtocol.isConfigured(drmData, drmConfig)) {\n        DashAdapter._availableDrmProtocol.push(drmProtocol);\n        break;\n      }\n    }\n    if (!DashAdapter._availableDrmProtocol.length) {\n      for (let drmProtocol of DashAdapter._drmProtocols) {\n        if (drmProtocol.canPlayDrm(drmData)) {\n          DashAdapter._availableDrmProtocol.push(drmProtocol);\n        }\n      }\n    }\n\n    return !!DashAdapter._availableDrmProtocol.length;\n  }\n\n  /**\n   * Checks if the dash adapter is supported\n   * @function isSupported\n   * @returns {boolean} -  Whether dash is supported.\n   * @static\n   */\n  static isSupported(): boolean {\n    /*\n    for browsers which don't have VTT cue we need to install a polyfill for both isBrowserSupported\n    check and also for playback, but we might not use Shaka so if we install the polyfill now just for browser support\n    check then uninstall it after, and call it again if we actually use DASH adapter for playback on init\n    this is in order to avoid collisions with other libs\n     */\n    let resetVttPolyfill = false;\n    if (!window.VTTCue) {\n      resetVttPolyfill = true;\n    }\n    shaka.polyfill.installAll();\n    let isSupported = shaka.Player.isBrowserSupported();\n    if (resetVttPolyfill) {\n      window.VTTCue = undefined;\n    }\n    DashAdapter._logger.debug('isSupported:' + isSupported);\n    return isSupported;\n  }\n\n  /**\n   * @constructor\n   * @param {HTMLVideoElement} videoElement - The video element which bind to the dash adapter\n   * @param {PKMediaSourceObject} source - The source object\n   * @param {Object} config - The media source adapter configuration\n   */\n  constructor(videoElement: HTMLVideoElement, source: PKMediaSourceObject, config: Object = {}) {\n    DashAdapter._logger.debug('Creating adapter. Shaka version: ' + shaka.Player.version);\n    super(videoElement, source, config);\n    this._config = Utils.Object.mergeDeep({}, DefaultConfig, this._config);\n    this._init();\n  }\n\n  /**\n   * Runs the initialization actions of the dash adapter.\n   * @private\n   * @returns {void}\n   */\n  _init(): void {\n    //Need to call this again cause we are uninstalling the VTTCue polyfill to avoid collisions with other libs\n    shaka.polyfill.installAll();\n    this._shaka = new shaka.Player();\n    // This will force the player to use shaka UITextDisplayer plugin to render text tracks.\n    if (this._config.useShakaTextTrackDisplay) {\n      this._shaka.setVideoContainer(Utils.Dom.getElementBySelector('.playkit-subtitles'));\n    }\n    this._maybeSetFilters();\n    this._maybeSetDrmConfig();\n    this._maybeBreakStalls();\n    this._shaka.configure(this._config.shakaConfig);\n    this._addBindings();\n  }\n\n  _clearStallInterval(): void {\n    if (this._stallInterval) {\n      clearInterval(this._stallInterval);\n      this._stallInterval = null;\n    }\n  }\n\n  _stallHandler(): void {\n    this._clearStallInterval();\n\n    const getCurrentTimeInSeconds = () => {\n      return Date.now() / 1000;\n    };\n    const lastUpdateTime = getCurrentTimeInSeconds();\n    let lastCurrentTime = this._videoElement.currentTime;\n\n    this._stallInterval = setInterval(() => {\n      const stallSeconds = getCurrentTimeInSeconds() - lastUpdateTime;\n      //waiting for 3 sec until checking stalling\n      if (stallSeconds > STALL_DETECTION_THRESHOLD && !this._videoElement.paused) {\n        if (lastCurrentTime === this._videoElement.currentTime) {\n          DashAdapter._logger.debug('stall found, break the stall');\n          this._videoElement.currentTime = parseFloat(this._videoElement.currentTime.toFixed(1)) + STALL_BREAK_THRESHOLD;\n        }\n        this._clearStallInterval();\n      }\n      lastCurrentTime = this._videoElement.currentTime;\n    }, STALL_DETECTION_INTERVAL);\n  }\n\n  /**\n   * register to event to break the stalls on smart TV\n   * @returns {void}\n   * @private\n   */\n  _maybeBreakStalls(): void {\n    if (this._config.forceBreakStall) {\n      this._eventManager.listen(this._videoElement, EventType.SEEKING, () => this._stallHandler());\n    }\n  }\n\n  /**\n   * get the redirected URL\n   * @param {string} url - The url to check for redirection\n   * @returns {Promise<string>} - the resolved url\n   * @private\n   */\n  _maybeGetRedirectedUrl(url: string): Promise<string> {\n    const shouldRedirect = this._config.forceRedirectExternalStreams;\n    const timeout = this._config.redirectExternalStreamsTimeout;\n    const callback = this._config.redirectExternalStreamsHandler;\n    return new Promise(resolve => {\n      if (!shouldRedirect) {\n        return resolve(url);\n      }\n      Utils.Http.jsonp(url, callback, {\n        timeout: timeout\n      })\n        .then(uri => {\n          resolve(uri);\n        })\n        .catch(() => resolve(url));\n    });\n  }\n\n  _maybeSetFilters(): void {\n    if (typeof Utils.Object.getPropertyPath(this._config, 'network.requestFilter') === 'function') {\n      DashAdapter._logger.debug('Register request filter');\n      this._shaka.getNetworkingEngine().registerRequestFilter((type, request) => {\n        if (Object.values(RequestType).includes(type)) {\n          const pkRequest: PKRequestObject = {url: request.uris[0], body: request.body, headers: request.headers};\n          let requestFilterPromise;\n          try {\n            requestFilterPromise = this._config.network.requestFilter(type, pkRequest);\n          } catch (error) {\n            requestFilterPromise = Promise.reject(error);\n          }\n          requestFilterPromise = requestFilterPromise || Promise.resolve(pkRequest);\n          return requestFilterPromise\n            .then(updatedRequest => {\n              request.uris = [updatedRequest.url];\n              request.headers = updatedRequest.headers;\n              if (typeof updatedRequest.withCredentials === 'boolean') {\n                request.allowCrossSiteCredentials = updatedRequest.withCredentials;\n              }\n              if (request.method === 'POST') {\n                request.body = updatedRequest.body;\n              } else if (updatedRequest.body) {\n                DashAdapter._logger.warn(`Request with ${request.method} method cannot have body`);\n              }\n            })\n            .catch(error => {\n              this._requestFilterError = true;\n              throw error;\n            });\n        }\n      });\n    }\n    if (typeof Utils.Object.getPropertyPath(this._config, 'network.responseFilter') === 'function') {\n      DashAdapter._logger.debug('Register response filter');\n      this._shaka.getNetworkingEngine().registerResponseFilter((type, response) => {\n        if (Object.values(RequestType).includes(type)) {\n          const {uri: url, data, headers} = response;\n          const pkResponse: PKResponseObject = {url, originalUrl: this._sourceObj.url, data, headers};\n          let responseFilterPromise;\n          try {\n            responseFilterPromise = this._config.network.responseFilter(type, pkResponse);\n          } catch (error) {\n            responseFilterPromise = Promise.reject(error);\n          }\n          responseFilterPromise = responseFilterPromise || Promise.resolve(pkResponse);\n          return responseFilterPromise\n            .then(updatedResponse => {\n              response.data = updatedResponse.data;\n            })\n            .catch(error => {\n              this._responseFilterError = true;\n              throw error;\n            });\n        }\n      });\n    }\n  }\n\n  /**\n   * Configure drm for shaka player.\n   * @private\n   * @returns {void}\n   */\n  _maybeSetDrmConfig(): void {\n    if (this._sourceObj && this._sourceObj.drmData) {\n      let config = {};\n      for (let drmProtocol of DashAdapter._availableDrmProtocol) {\n        drmProtocol.setDrmPlayback(config, this._sourceObj.drmData);\n        // If shaka config already has some drm configuration override the config defaults with it\n        if (this._config.shakaConfig.drm) {\n          Utils.Object.mergeDeep(config.drm, this._config.shakaConfig.drm);\n        }\n        Utils.Object.mergeDeep(this._config.shakaConfig, config);\n      }\n    }\n  }\n\n  /**\n   * apply Capping to player size restrictions\n   * @private\n   * @returns {void}\n   */\n  _maybeCapLevelToPlayerSize(): void {\n    if (this._config.capLevelToPlayerSize) {\n      const getRestrictions = () => {\n        return {\n          minHeight: 0,\n          maxHeight: this._videoHeight,\n          minWidth: 0,\n          maxWidth: this._videoWidth,\n          minBitrate: 0,\n          maxBitrate: Infinity\n        };\n      };\n      this._clearVideoUpdateTimer();\n      this._videoSizeUpdateTimer = setInterval(() => this._updateRestriction(getRestrictions()), ABR_RESTRICTION_UPDATE_INTERVAL);\n      this._updateRestriction(getRestrictions());\n    }\n  }\n\n  /**\n   * apply ABR restrictions\n   * @private\n   * @returns {void}\n   */\n  _maybeApplyAbrRestrictions(): void {\n    if (!this._config.capLevelToPlayerSize) {\n      this._clearVideoUpdateTimer();\n      if (Utils.Object.hasPropertyPath(this._config, 'abr.restrictions')) {\n        this._updateRestriction(this._config.abr.restrictions);\n      }\n    }\n  }\n\n  /**\n   * apply ABR restrictions by size\n   * @private\n   * @param {PKABRRestrictionObject} restrictions - abr restrictions config\n   * @returns {void}\n   */\n  _updateRestriction(restrictions: PKABRRestrictionObject): void {\n    const shakaRestrictionsConfig = this._getRestrictionShakaConfig(restrictions);\n    this._shaka.configure({\n      abr: {\n        restrictions: shakaRestrictionsConfig\n      }\n    });\n  }\n\n  _getRestrictionShakaConfig(restrictions: PKABRRestrictionObject): Object {\n    const getMinDimensions = (dim): number => {\n      const videoTracks = this._getVideoTracks();\n      return Math.min.apply(\n        null,\n        videoTracks.map(variant => variant[dim])\n      );\n    };\n    let restrictionsShakaConfig = {};\n    if (restrictions) {\n      let {maxHeight, maxWidth, maxBitrate, minHeight, minWidth, minBitrate} = restrictions;\n      const minHeightValue = Math.max(minHeight, 0);\n      const maxHeightValue = Math.max(maxHeight, getMinDimensions('height'));\n      if (maxHeightValue >= minHeightValue) {\n        restrictionsShakaConfig.minHeight = minHeightValue;\n        restrictionsShakaConfig.maxHeight = maxHeightValue;\n      } else {\n        DashAdapter._logger.warn('Invalid maxHeight restriction, maxHeight must be greater than minHeight', minHeight, maxHeight);\n      }\n      const minWidthValue = Math.max(minWidth, 0);\n      const maxWidthValue = Math.max(maxWidth, getMinDimensions('width'));\n      if (maxWidthValue >= minWidthValue) {\n        restrictionsShakaConfig.minWidth = minWidthValue;\n        restrictionsShakaConfig.maxWidth = maxWidthValue;\n      } else {\n        DashAdapter._logger.warn('Invalid maxWidth restriction, maxWidth must be greater than minWidth', minWidth, maxWidth);\n      }\n      const minBitrateValue = Math.max(minBitrate, 0);\n      const maxBitrateValue = Math.max(maxBitrate, getMinDimensions('bandwidth'));\n      if (maxBitrateValue >= minBitrateValue) {\n        restrictionsShakaConfig.minBandwidth = minBitrateValue;\n        restrictionsShakaConfig.maxBandwidth = maxBitrateValue;\n      } else {\n        DashAdapter._logger.warn('Invalid maxBitrate restriction, maxBitrate must be greater than minBitrate', minBitrate, maxBitrate);\n      }\n    }\n    return restrictionsShakaConfig;\n  }\n\n  /**\n   * attach media - return the media source to handle the video tag\n   * @public\n   * @returns {void}\n   */\n  attachMediaSource(): void {\n    if (!this._shaka) {\n      if (this._videoElement && this._videoElement.src) {\n        Utils.Dom.setAttribute(this._videoElement, 'src', '');\n        Utils.Dom.removeAttribute(this._videoElement, 'src');\n      }\n      this._init();\n    }\n  }\n\n  /**\n   * detach media - will remove the media source from handling the video\n   * @public\n   * @returns {Promise<void>} - detach promise\n   */\n  detachMediaSource(): Promise<void> {\n    if (this._shaka) {\n      // 1 second different between duration and current time will signal as end - will enable replay button\n      if (Math.floor(this.duration - this.currentTime) === 0) {\n        this._lastTimeDetach = 0;\n      } else if (this.currentTime > 0) {\n        this._lastTimeDetach = this.currentTime;\n      }\n      return this._reset().then(() => {\n        this._shaka = null;\n        this._loadPromise = null;\n      });\n    } else {\n      return Promise.resolve();\n    }\n  }\n\n  /**\n   * Clear the video update timer\n   * @private\n   * @returns {void}\n   */\n  _clearVideoUpdateTimer(): void {\n    if (this._videoSizeUpdateTimer) {\n      clearInterval(this._videoSizeUpdateTimer);\n      this._videoSizeUpdateTimer = null;\n    }\n  }\n\n  get _videoWidth(): ?number {\n    let width;\n    const videoElement = this._videoElement;\n    if (videoElement) {\n      width = videoElement.width || videoElement.clientWidth || videoElement.offsetWidth;\n      width *= this._contentScaleFactor;\n    }\n    return width;\n  }\n\n  get _videoHeight(): ?number {\n    let height;\n    const videoElement = this._videoElement;\n    if (videoElement) {\n      height = videoElement.height || videoElement.clientHeight || videoElement.offsetHeight;\n      height *= this._contentScaleFactor;\n    }\n    return height;\n  }\n\n  get _contentScaleFactor(): number {\n    let pixelRatio = 1;\n    try {\n      pixelRatio = window.devicePixelRatio;\n    } catch (e) {\n      DashAdapter._logger.debug('failed reading devicePixelRatio, assume 1');\n    }\n    return pixelRatio;\n  }\n\n  /**\n   * Add the required bindings to shaka.\n   * @function _addBindings\n   * @private\n   * @returns {void}\n   */\n  _addBindings(): void {\n    this._eventManager.listen(this._shaka, ShakaEvent.ADAPTATION, this._adapterEventsBindings.adaptation);\n    this._eventManager.listen(this._shaka, ShakaEvent.ERROR, this._adapterEventsBindings.error);\n    this._eventManager.listen(this._shaka, ShakaEvent.DRM_SESSION_UPDATE, this._adapterEventsBindings.drmsessionupdate);\n    this._eventManager.listen(this._videoElement, EventType.WAITING, this._adapterEventsBindings.waiting);\n    this._eventManager.listen(this._videoElement, EventType.PLAYING, this._adapterEventsBindings.playing);\n    this._eventManager.listen(this._videoElement, EventType.LOADED_DATA, () => this._onLoadedData());\n    this._eventManager.listenOnce(this._videoElement, EventType.PLAYING, () => {\n      this._eventManager.listen(this._shaka, ShakaEvent.BUFFERING, this._adapterEventsBindings.buffering);\n    });\n    if (this._config.trackEmsgEvents) {\n      this._eventManager.listen(this._shaka, ShakaEvent.EMSG, this._adapterEventsBindings.emsg);\n    }\n\n    // called when a resource is downloaded\n    this._shaka.getNetworkingEngine().registerResponseFilter((type, response) => {\n      switch (type) {\n        case shaka.net.NetworkingEngine.RequestType.SEGMENT:\n          this._trigger(EventType.FRAG_LOADED, {\n            miliSeconds: response.timeMs,\n            bytes: response.data.byteLength,\n            url: response.uri\n          });\n          if (this.isLive()) {\n            this._dispatchNativeEvent(EventType.DURATION_CHANGE);\n          }\n          break;\n        case shaka.net.NetworkingEngine.RequestType.MANIFEST:\n          this._parseManifest(response.data);\n          this._playbackActualUri = response.uri;\n          this._trigger(EventType.MANIFEST_LOADED, {miliSeconds: response.timeMs});\n          setTimeout(() => {\n            this._isLive = this._isLive || this._shaka?.isLive();\n            if (this._isLive && !this._shaka?.isLive() && !this._isStaticLive) {\n              this._sourceObj.url = response.uri;\n              this._switchFromDynamicToStatic();\n            }\n          });\n          break;\n      }\n    });\n  }\n\n  _onLoadedData(): void {\n    this._setLowLatencyMode();\n    const segmentDuration = this.getSegmentDuration();\n    this._seekRangeStart = this._shaka.seekRange().start;\n    this._startOverTimeout = setTimeout(() => {\n      if (this._shaka.seekRange().start - this._seekRangeStart >= segmentDuration) {\n        // in start over the seekRange().start should be permanent\n        this._isStartOver = false;\n      }\n    }, (segmentDuration + 1) * 1000);\n  }\n\n  _switchFromDynamicToStatic(): void {\n    DashAdapter._logger.debug('Switch from dynamic manifest to static');\n    const distanceFromLive = this._getLiveEdge() - this._videoElement.currentTime;\n    this._dispatchNativeEvent(EventType.WAITING);\n    const isAdaptiveBitrateEnabled = this.isAdaptiveBitrateEnabled();\n    const paused = this._videoElement.paused;\n    // const {maxHeight} = this._shaka.getConfiguration().abr.restrictions;\n    this.detachMediaSource().then(() => {\n      this._isStaticLive = true;\n      this._isLive = true;\n      this.attachMediaSource();\n      // if (isAdaptiveBitrateEnabled) {\n      //   this._shaka.configure({abr: {restrictions: {maxHeight: 0}}});\n      // }\n      this.load().then(() => {\n        this._videoElement.currentTime = this._videoElement.duration - distanceFromLive;\n        !paused && this._videoElement.play();\n        if (isAdaptiveBitrateEnabled) {\n          this._onAdaptation();\n          // this._eventManager.listenOnce(this._videoElement, EventType.PLAYING, () => {\n          //   this._shaka.configure({abr: {restrictions: {maxHeight}}});\n          // });\n        } else if (this._selectedVideoTrack) {\n          DashAdapter._logger.debug('Select the selected video track');\n          this.selectVideoTrack(this._selectedVideoTrack);\n        }\n      });\n    });\n  }\n\n  _setLowLatencyMode() {\n    this._shaka.configure({\n      streaming: {\n        lowLatencyMode: typeof this._config.lowLatencyMode === 'boolean' ? this._config.lowLatencyMode : this.isLive()\n      }\n    });\n  }\n\n  /**\n   * Custom parser to retrieve image adaptation sets.\n   * @param {ArrayBuffer} manifestBuffer - The array buffer manifest from the response.\n   * @function _parseManifest\n   * @private\n   * @returns {void}\n   */\n  _parseManifest(manifestBuffer: ArrayBuffer): void {\n    if (!this._manifestParser && DashManifestParser.isValid()) {\n      DashAdapter._logger.debug('Creating parser for the first time');\n      this._manifestParser = new DashManifestParser(manifestBuffer);\n      this._manifestParser.parseManifest();\n    }\n  }\n\n  /**\n   * Load the video source\n   * @param {number} startTime - Optional time to start the video from.\n   * @function load\n   * @override\n   */\n  async load(startTime: ?number): Promise<Object> {\n    if (!this._loadPromise) {\n      await this._removeMediaKeys();\n      this._shaka.attach(this._videoElement);\n      this._loadPromise = new Promise((resolve, reject) => {\n        if (this._sourceObj && this._sourceObj.url) {\n          this._trigger(EventType.ABR_MODE_CHANGED, {mode: this.isAdaptiveBitrateEnabled() ? 'auto' : 'manual'});\n          let shakaStartTime = startTime && startTime > -1 ? startTime : undefined;\n          shakaStartTime = isNaN(this._lastTimeDetach) ? shakaStartTime : this._lastTimeDetach;\n          this._lastTimeDetach = NaN;\n          this._maybeGetRedirectedUrl(this._sourceObj.url)\n            .then(url => {\n              return this._shaka.load(url, shakaStartTime);\n            })\n            .then(() => {\n              const data = {tracks: this._getParsedTracks()};\n              this._maybeCapLevelToPlayerSize();\n              DashAdapter._logger.debug('The source has been loaded successfully');\n              resolve(data);\n            })\n            .catch(error => {\n              reject(new Error(this._isDestroyInProgress ? Error.Severity.RECOVERABLE : error.severity, error.category, error.code, error.data));\n            });\n        }\n      });\n    }\n    return this._loadPromise;\n  }\n\n  /**\n   * Destroys the dash adapter\n   * @function destroy\n   * @override\n   * @returns {Promise<*>} - The destroy promise.\n   */\n  destroy(): Promise<*> {\n    this._isDestroyInProgress = true;\n    return new Promise((resolve, reject) => {\n      super.destroy().then(() => {\n        DashAdapter._logger.debug('destroy');\n        this._loadPromise = null;\n        this._adapterEventsBindings = {};\n        this._reset()\n          .then(resetResult => {\n            this._isDestroyInProgress = false;\n            resolve(resetResult);\n          })\n          .catch(error => {\n            this._isDestroyInProgress = false;\n            reject(error);\n          });\n      });\n    });\n  }\n\n  /**\n   *  Returns in-stream thumbnail for a chosen time.\n   * @param {number} time - playback time.\n   * @public\n   * @return {?ThumbnailInfo} - Thumbnail info\n   */\n  getThumbnail(time: number): ?ThumbnailInfo {\n    if (this._thumbnailController) {\n      return this._thumbnailController.getThumbnail(time);\n    }\n  }\n\n  /**\n   * reset shaka instance and its bindings\n   * @function _reset\n   * @private\n   * @returns {Promise<*>} - The destroy promise.\n   */\n  _reset(): Promise<*> {\n    this._buffering = false;\n    this._waitingSent = false;\n    this._playingSent = false;\n    this._isLive = false;\n    this._isStaticLive = false;\n    this._requestFilterError = false;\n    this._responseFilterError = false;\n    this._manifestParser = null;\n    this._thumbnailController = null;\n    this._clearStallInterval();\n    this._clearVideoUpdateTimer();\n    clearTimeout(this._startOverTimeout);\n    if (this._eventManager) {\n      this._eventManager.removeAll();\n    }\n    if (this._shaka) {\n      return this._shaka.destroy();\n    }\n    return Promise.resolve();\n  }\n\n  /**\n   * Remove mediaKeys from the video element.\n   * mediaKeys are set if an encrypted media was previously played, and must be removed before a new encrypted media can be played.\n   * If mediaKeys are not null it means that shaka reset wasn't called or that it failed to remove them.\n   * @returns {Promise<void>} Promise that resolves when the operation finishes.\n   */\n  async _removeMediaKeys(): Promise<void> {\n    if (this._videoElement && this._videoElement.mediaKeys) {\n      try {\n        DashAdapter._logger.debug('Removing mediaKeys from the video element');\n        await this._videoElement.setMediaKeys(null);\n        DashAdapter._logger.debug('mediaKeys removed');\n      } catch (e) {\n        // non encrypted playback should still work, so we don't reject\n        this._logger.warn('mediaKeys not cleared');\n      } finally {\n        // eslint-disable-next-line no-unsafe-finally\n        return Promise.resolve();\n      }\n    } else {\n      return Promise.resolve();\n    }\n  }\n\n  /**\n   * Get the original video tracks\n   * @function _getVideoTracks\n   * @returns {Array<Object>} - The original video tracks\n   * @private\n   */\n  _getVideoTracks(): Array<Object> {\n    let variantTracks = this._shaka.getVariantTracks();\n    let activeVariantTrack = this._getActiveTrack();\n    let videoTracks = variantTracks.filter(variantTrack => {\n      return variantTrack.audioId === activeVariantTrack.audioId;\n    });\n    return videoTracks;\n  }\n\n  _getActiveTrack(): Object {\n    return this._shaka.getVariantTracks().find(variantTrack => variantTrack.active);\n  }\n\n  /**\n   * Get the original audio tracks\n   * @function _getAudioTracks\n   * @returns {Array<Object>} - Array of objects with unique language and label.\n   * @private\n   */\n  _getAudioTracks(): Array<Object> {\n    const variantTracks = this._shaka.getVariantTracks();\n    let audioTracks = this._shaka.getAudioLanguagesAndRoles();\n    audioTracks.forEach(track => {\n      const sameLangAudioVariants = variantTracks.filter(vt => vt.language === track.language);\n      const id = sameLangAudioVariants.map(variant => variant.id).join('_');\n      const active = sameLangAudioVariants.some(variant => variant.active);\n      track.id = id;\n      track.label = sameLangAudioVariants[0].label;\n      track.active = active;\n    });\n    return audioTracks;\n  }\n\n  /**\n   * Get the parsed tracks\n   * @function _getParsedTracks\n   * @returns {Array<Track>} - The parsed tracks\n   * @private\n   */\n  _getParsedTracks(): Array<Track> {\n    if (this._shaka) {\n      const videoTracks = this._getParsedVideoTracks();\n      const audioTracks = this._getParsedAudioTracks();\n      const textTracks = this._getParsedTextTracks();\n      const imageTracks = this._getParsedImageTracks();\n      return videoTracks.concat(audioTracks).concat(textTracks).concat(imageTracks);\n    }\n    return [];\n  }\n\n  /**\n   * Get the parsed video tracks\n   * @function _getParsedVideoTracks\n   * @returns {Array<VideoTrack>} - The parsed video tracks\n   * @private\n   */\n  _getParsedVideoTracks(): Array<VideoTrack> {\n    let videoTracks = this._getVideoTracks();\n    let parsedTracks = [];\n    if (videoTracks) {\n      for (let i = 0; i < videoTracks.length; i++) {\n        let settings = {\n          id: videoTracks[i].id,\n          bandwidth: videoTracks[i].videoBandwidth || videoTracks[i].bandwidth,\n          width: videoTracks[i].width,\n          height: videoTracks[i].height,\n          active: videoTracks[i].active,\n          index: i\n        };\n        parsedTracks.push(new VideoTrack(settings));\n      }\n    }\n    return parsedTracks;\n  }\n\n  /**\n   * Get the parsed audio tracks\n   * @function _getParsedAudioTracks\n   * @returns {Array<AudioTrack>} - The parsed audio tracks\n   * @private\n   */\n  _getParsedAudioTracks(): Array<AudioTrack> {\n    let audioTracks = this._getAudioTracks();\n    let parsedTracks = [];\n    if (audioTracks) {\n      for (let i = 0; i < audioTracks.length; i++) {\n        let settings = {\n          id: audioTracks[i].id,\n          active: audioTracks[i].active,\n          label: audioTracks[i].label,\n          language: audioTracks[i].language,\n          index: i\n        };\n        parsedTracks.push(new AudioTrack(settings));\n      }\n    }\n    return parsedTracks;\n  }\n\n  /**\n   * Get the parsed text tracks\n   * @function _getParsedTextTracks\n   * @returns {Array<TextTrack>} - The parsed text tracks\n   * @private\n   */\n  _getParsedTextTracks(): Array<TextTrack> {\n    let parsedTracks = [];\n    for (const textTrack of this._shaka.getTextTracks()) {\n      let kind = textTrack.kind ? textTrack.kind + 's' : '';\n      kind = kind === '' && this._config.useShakaTextTrackDisplay ? 'captions' : kind;\n      let settings = {\n        id: textTrack.id,\n        kind: kind,\n        active: false,\n        label: textTrack.label,\n        language: textTrack.language\n      };\n      parsedTracks.push(new TextTrack(settings));\n    }\n    return parsedTracks;\n  }\n\n  /**\n   * Get the parsed image tracks\n   * @function _getParsedImageTracks\n   * @returns {Array<ImageTrack>} - The parsed image tracks\n   * @private\n   */\n  _getParsedImageTracks(): Array<ImageTrack> {\n    const imageSet = this._manifestParser?.getImageSet();\n    const mediaTemplatePrefix = this._manifestParser?.getBaseUrl() || '';\n    if (imageSet) {\n      this._thumbnailController = new DashThumbnailController(imageSet, this._playbackActualUri, mediaTemplatePrefix);\n      return this._thumbnailController.getTracks();\n    }\n    return [];\n  }\n\n  /**\n   * Select a video track\n   * @function selectVideoTrack\n   * @param {VideoTrack} videoTrack - the video track to select\n   * @returns {void}\n   * @public\n   */\n  selectVideoTrack(videoTrack: VideoTrack): void {\n    if (this._shaka) {\n      let videoTracks = this._getVideoTracks();\n      if (videoTrack instanceof VideoTrack && videoTracks) {\n        let selectedVideoTrack = videoTracks[videoTrack.index];\n        if (selectedVideoTrack) {\n          if (this.isAdaptiveBitrateEnabled()) {\n            this._shaka.configure({abr: {enabled: false}});\n            this._trigger(EventType.ABR_MODE_CHANGED, {mode: 'manual'});\n          }\n          if (!selectedVideoTrack.active) {\n            this._selectedVideoTrack = videoTrack;\n            this._shaka.selectVariantTrack(videoTracks[videoTrack.index], true);\n            this._onTrackChanged(videoTrack);\n          }\n        }\n      }\n    }\n  }\n\n  /**\n   * Select an audio track\n   * @function selectAudioTrack\n   * @param {AudioTrack} audioTrack - the audio track to select\n   * @returns {void}\n   * @public\n   */\n  selectAudioTrack(audioTrack: AudioTrack): void {\n    if (this._shaka && audioTrack instanceof AudioTrack && !audioTrack.active) {\n      this._shaka.selectAudioLanguage(audioTrack.language);\n      this._onTrackChanged(audioTrack);\n    }\n  }\n\n  /**\n   * Select a text track\n   * @function selectTextTrack\n   * @param {TextTrack} textTrack - the track to select\n   * @returns {void}\n   * @public\n   */\n  selectTextTrack(textTrack: TextTrack): void {\n    if (this._shaka && textTrack instanceof TextTrack && !textTrack.active && (textTrack.kind === 'subtitles' || textTrack.kind === 'captions')) {\n      this._shaka.setTextTrackVisibility(this._config.textTrackVisibile);\n      this._shaka.selectTextLanguage(textTrack.language);\n      this._onTrackChanged(textTrack);\n    }\n  }\n\n  selectImageTrack(imageTrack: ImageTrack): void {\n    if (this._shaka && this._thumbnailController && imageTrack instanceof ImageTrack && !imageTrack.active) {\n      this._thumbnailController.selectTrack(imageTrack);\n      this._onTrackChanged(ImageTrack);\n    }\n  }\n\n  /**\n   * Hide the text track\n   * @function hideTextTrack\n   * @returns {void}\n   * @public\n   */\n  hideTextTrack(): void {\n    if (this._shaka) {\n      this._shaka.setTextTrackVisibility(false);\n    }\n  }\n\n  /**\n   * Enables adaptive bitrate switching\n   * @function enableAdaptiveBitrate\n   * @returns {void}\n   * @public\n   */\n  enableAdaptiveBitrate(): void {\n    if (this._shaka && !this.isAdaptiveBitrateEnabled()) {\n      this._trigger(EventType.ABR_MODE_CHANGED, {mode: 'auto'});\n      this._shaka.configure({abr: {enabled: true}});\n    }\n  }\n\n  /**\n   * Checking if adaptive bitrate switching is enabled.\n   * @function isAdaptiveBitrateEnabled\n   * @returns {boolean} - Whether adaptive bitrate is enabled.\n   * @public\n   */\n  isAdaptiveBitrateEnabled(): boolean {\n    if (this._shaka) {\n      let shakaConfig = this._shaka.getConfiguration();\n      return shakaConfig.abr.enabled;\n    }\n    return false;\n  }\n\n  /**\n   * Apply ABR restriction.\n   * @function applyABRRestriction\n   * @param {PKABRRestrictionObject} restrictions - abr restrictions config\n   * @returns {void}\n   * @public\n   */\n  applyABRRestriction(restrictions: PKABRRestrictionObject): void {\n    Utils.Object.createPropertyPath(this._config, 'abr.restrictions', restrictions);\n    this._maybeApplyAbrRestrictions();\n    if (!this.isAdaptiveBitrateEnabled()) {\n      const videoTracks = this._getParsedVideoTracks();\n      const availableTracks = filterTracksByRestriction(videoTracks, this._config.abr.restrictions);\n      if (availableTracks.length) {\n        const activeTrackInRange = availableTracks.find(track => track.active);\n        if (!activeTrackInRange) {\n          this.selectVideoTrack(availableTracks[0]);\n        }\n      }\n    }\n  }\n\n  /**\n   * Returns the live edge\n   * @returns {number} - live edge\n   * @private\n   */\n  _getLiveEdge(): number {\n    return this._shaka ? this._shaka.seekRange().end : NaN;\n  }\n\n  /**\n   * Seeking to live edge.\n   * @function seekToLiveEdge\n   * @returns {void}\n   * @public\n   */\n  seekToLiveEdge(): void {\n    if (this._shaka && this._videoElement.readyState > 0) {\n      this._videoElement.currentTime = this._getLiveEdge();\n    }\n  }\n\n  /**\n   * Checking if the current playback is live.\n   * @function isLive\n   * @returns {boolean} - Whether playback is live.\n   * @public\n   */\n  isLive(): boolean {\n    return this._shaka?.isLive() || this._isLive;\n  }\n\n  /**\n   * Gets the segment duration of the stream\n   * @return {number} - Segment duration in seconds\n   */\n  get liveDuration() {\n    return this._getLiveEdge();\n  }\n\n  /**\n   * Gets the live duration\n   * @return {number} - live duration\n   */\n  getSegmentDuration(): number {\n    if (this._shaka) {\n      return this._shaka.getStats().maxSegmentDuration;\n    }\n    return 0;\n  }\n\n  /**\n   * An handler to shaka adaptation event\n   * @function _onAdaptation\n   * @returns {void}\n   * @private\n   */\n  _onAdaptation(): void {\n    let selectedVideoTrack = this._getParsedVideoTracks().find(videoTrack => videoTrack.active);\n    this._onTrackChanged(selectedVideoTrack);\n  }\n\n  /**\n   * An handler to shaka error event\n   * @function _onError\n   * @param {any} event - the error event\n   * @returns {void}\n   * @private\n   */\n  _onError(event: any): void {\n    if (event && event.detail) {\n      let error = event.detail;\n      //don't handle video element errors, they are already handled by the player\n      if (error.code === this.VIDEO_ERROR_CODE) {\n        return;\n      }\n      if ((this._requestFilterError || this._responseFilterError) && error.data[0] instanceof shaka.util.Error) {\n        // When the request/response filter of the license request throws an error,\n        // shaka wraps the request/response filter error (code 1006/1007) with a license request error (code 6007)\n        // so extract the inner error\n        error = error.data[0];\n        this._requestFilterError ? (this._requestFilterError = false) : (this._responseFilterError = false);\n      }\n      this._trigger(EventType.ERROR, new Error(error.severity, error.category, error.code, error.data));\n      DashAdapter._logger.error(error);\n      if (error.severity === Error.Severity.CRITICAL) {\n        this.destroy();\n      }\n    }\n  }\n\n  /**\n   * An handler to shaka buffering event\n   * @function _onBuffering\n   * @param {any} event - the buffering event\n   * @returns {void}\n   * @private\n   */\n  _onBuffering(event: any): void {\n    if (event.buffering) {\n      if (!this._waitingSent) {\n        // The player enters the buffering state and 'waiting' event hasn't been sent by the HTMLVideoElement.\n        this._dispatchNativeEvent(EventType.WAITING);\n        this._buffering = true;\n      }\n    } else {\n      this._buffering = false;\n      if (!this._videoElement.paused && !this._playingSent) {\n        //the player leaves the buffering state. and 'playing' event hasn't been sent by the HTMLVideoElement.\n        this._dispatchNativeEvent(EventType.PLAYING);\n      }\n    }\n  }\n\n  _dispatchNativeEvent(type: string): void {\n    let event;\n    if (typeof window.Event === 'function') {\n      event = new Event(type);\n    } else {\n      event = document.createEvent('Event');\n      event.initEvent(type, true, true);\n    }\n    this._videoElement.dispatchEvent(event);\n  }\n\n  /**\n   * An handler to shaka drm session update event\n   * @function _onDrmSessionUpdate\n   * @returns {void}\n   * @private\n   */\n  _onDrmSessionUpdate(): void {\n    this._trigger(EventType.DRM_LICENSE_LOADED, {\n      licenseTime: this._shaka.getStats().licenseTime,\n      scheme: this._shaka.drmInfo().keySystem\n    });\n  }\n\n  /**\n   * An handler to shaka emsg event\n   * @function _onEmsg\n   * @param {any} event - the emsg event\n   * @returns {void}\n   * @private\n   */\n  _onEmsg(event: any): void {\n    const {detail, type} = event;\n    let metadataTrack = Array.from(this._videoElement.textTracks).find(track => track.label === type);\n    if (!metadataTrack) {\n      metadataTrack = this._videoElement.addTextTrack(TextTrack.KIND.METADATA, type);\n    }\n    const {startTime, endTime, id, ...metadata} = detail;\n\n    const timedMetadata = new TimedMetadata(startTime, endTime, id, TimedMetadata.TYPE.EMSG, metadata);\n    const textTrackCue = createTextTrackCue(timedMetadata);\n    metadataTrack.addCue(textTrackCue);\n    this._trigger(EventType.TIMED_METADATA_ADDED, {cues: [timedMetadata]});\n  }\n\n  /**\n   * An handler to HTMLVideoElement waiting event\n   * @function _onWaiting\n   * @returns {void}\n   * @private\n   */\n  _onWaiting(): void {\n    this._waitingSent = true;\n    this._playingSent = false;\n  }\n\n  /**\n   * An handler to HTMLVideoElement playing event\n   * @function _onPlaying\n   * @returns {void}\n   * @private\n   */\n  _onPlaying(): void {\n    this._playingSent = true;\n    this._waitingSent = false;\n    if (this._buffering) {\n      // The player is in buffering state.\n      this._dispatchNativeEvent(EventType.WAITING);\n    }\n  }\n\n  /**\n   * Get the start time of DVR window in live playback in seconds.\n   * @returns {Number} - start time of DVR window.\n   * @public\n   */\n  getStartTimeOfDvrWindow(): number {\n    if (this.isLive() && this._shaka) {\n      return (this._isStartOver ? this._seekRangeStart : this._shaka.seekRange().start) + this._shaka.getConfiguration().streaming.safeSeekOffset;\n    }\n    return 0;\n  }\n\n  /**\n   * gets the target buffer of the player\n   * @returns {number} - buffer length target in seconds\n   */\n  get targetBuffer(): number {\n    let targetBufferVal = NaN;\n    if (!this._shaka) return NaN;\n    if (this.isLive()) {\n      targetBufferVal = this._getLiveEdge() - this._videoElement.currentTime;\n    } else {\n      // consideration of the end of the playback in the target buffer calc\n      targetBufferVal = this._videoElement.duration - this._videoElement.currentTime;\n    }\n\n    targetBufferVal = Math.min(targetBufferVal, this._shaka.getConfiguration().streaming.bufferingGoal + this._shaka.getStats().maxSegmentDuration);\n    return targetBufferVal;\n  }\n\n  getDrmInfo(): ?PKDrmDataObject {\n    const drmInfo = this._shaka.drmInfo();\n    if (!drmInfo) {\n      return null;\n    } else {\n      const {licenseServerUri, keySystem, serverCertificateUri} = drmInfo;\n      const drmDataObject: PKDrmDataObject = {\n        licenseUrl: licenseServerUri,\n        scheme: keySystem\n      };\n      if (serverCertificateUri) drmDataObject.certificate = serverCertificateUri;\n      return drmDataObject;\n    }\n  }\n}\n","// @flow\nimport {AdaptationSet} from './parser/adaptation-set';\nimport {Representation} from './parser/representation';\nimport {UrlUtils} from './parser/parser-utils';\nimport {ImageTrack, ThumbnailInfo} from '@playkit-js/playkit-js';\nimport {EssentialProperty} from './parser/essential-property';\n\nclass DashThumbnailController {\n  _tracks: Array<ImageTrack> = [];\n\n  constructor(set: AdaptationSet, playerUrl: string, mediaTemplatePrefix: string) {\n    this._parseTracks(set, playerUrl, mediaTemplatePrefix);\n    if (this._tracks.length > 0) {\n      this._tracks.sort((t1: ImageTrack, t2: ImageTrack) => t1.customData.bitrate - t2.customData.bitrate);\n      this.selectTrack(this._tracks[this._tracks.length - 1]);\n    }\n  }\n\n  selectTrack(track: ImageTrack): void {\n    this._tracks.forEach((t: ImageTrack) => (t.index === track.index ? (t.active = true) : (t.active = false)));\n  }\n\n  getTracks(): Array<ImageTrack> {\n    return this._tracks;\n  }\n\n  getActiveTrack(): ImageTrack {\n    return this._tracks.find((t: ImageTrack) => t.active);\n  }\n\n  getThumbnail(time: number): ThumbnailInfo {\n    const activeTrack = this.getActiveTrack();\n    const {duration, rows, cols, sliceWidth, sliceHeight, customData} = activeTrack;\n    const page = Math.floor(time / duration) + customData.startNumber;\n    const offset = time % duration;\n    const thumbIndex = Math.floor((offset * rows * cols) / duration);\n    return new ThumbnailInfo({\n      width: Math.floor(sliceWidth),\n      height: Math.floor(sliceHeight),\n      x: Math.floor(thumbIndex % rows) * sliceWidth,\n      y: Math.floor(thumbIndex / rows) * sliceHeight,\n      url: this._buildUrlFromTemplate(activeTrack, page)\n    });\n  }\n\n  _parseTracks = (set: AdaptationSet, playerUrl: string, mediaTemplatePrefix: string): void => {\n    const {representations, segmentTemplate, essentialProperty} = set;\n    representations.forEach((representation: Representation, index: number) => {\n      const {id, bandwidth, width, height} = representation;\n      const {startNumber, duration, media, timescale, presentationTimeOffset} = segmentTemplate;\n      const value = this._getEssentialValue(essentialProperty, representation);\n      const [rows, cols] = this._getDimensions(value);\n      this._tracks.push(\n        new ImageTrack({\n          id,\n          index,\n          active: false,\n          width,\n          height,\n          duration,\n          rows,\n          cols,\n          url: this._buildTemplateUrl(media, id, playerUrl, mediaTemplatePrefix),\n          customData: {\n            bitrate: bandwidth,\n            startNumber,\n            timescale,\n            presentationTimeOffset\n          }\n        })\n      );\n    });\n  };\n\n  _getDimensions = (value: string): Array<number> => {\n    let rows = 1,\n      cols = 1;\n    if (value.includes('x')) {\n      const values = value.split('x');\n      rows = parseInt(values[0]);\n      cols = parseInt(values[1]);\n    }\n    return [rows, cols];\n  };\n\n  _getEssentialValue = (essentialProperty: ?EssentialProperty, representation: Representation): string => {\n    return essentialProperty ? essentialProperty.value : representation.essentialProperty ? representation.essentialProperty.value : '';\n  };\n\n  _buildTemplateUrl = (mediaTemplate: string, id: string, url: string, mediaTemplatePrefix: string): string => {\n    const last = url.split('/').pop();\n    const baseUrl = url.replace(last, '');\n    const regex = /^\\.\\/|^\\./;\n    mediaTemplatePrefix = mediaTemplatePrefix.replace(regex, '');\n    if (mediaTemplatePrefix.length > 0 && !mediaTemplatePrefix.endsWith('/')) {\n      mediaTemplatePrefix += '/';\n    }\n    const urlTemplate = `${baseUrl}${mediaTemplatePrefix}${mediaTemplate}`;\n    return UrlUtils.resolve(urlTemplate, {id});\n  };\n\n  _buildUrlFromTemplate = (track: ImageTrack, index: number): string => {\n    return UrlUtils.resolve(track.url, {\n      index,\n      time: (index - 1) * track.duration * track.customData.timescale,\n      bitrate: track.customData.bitrate\n    });\n  };\n}\n\nexport {DashThumbnailController};\n","// @flow\nimport {IDrmProtocol, DrmScheme, getLogger} from '@playkit-js/playkit-js';\n\nconst PlayReady: IDrmProtocol = class PlayReady {\n  static _logger = getLogger('PlayReady');\n\n  /**\n   * PLAYREADY is the configure key system.\n   * @param {Array<Object>} drmData - The drm data.\n   * @param {PKDrmConfigObject} drmConfig - The drm config.\n   * @return {boolean} - Whether PLAYREADY is the configure key system.\n   */\n  static isConfigured(drmData: Array<Object>, drmConfig: PKDrmConfigObject): boolean {\n    return DrmScheme.PLAYREADY === drmConfig.keySystem && !!drmData.find(drmEntry => drmEntry.scheme === drmConfig.keySystem);\n  }\n\n  /**\n   * PlayReady playback supports in case 2 conditions are met:\n   * 1. The environment supports PlayReady playback.\n   * 2. The drm data of the source object contains entry with PlayReady scheme.\n   * @param {Array<Object>} drmData - The drm data to check.\n   * @return {boolean} - Whether PlayReady can be play on the current environment.\n   */\n  static canPlayDrm(drmData: Array<Object>): boolean {\n    PlayReady._logger.debug('Can play DRM scheme of: ' + DrmScheme.PLAYREADY);\n    return !!drmData.find(drmEntry => drmEntry.scheme === DrmScheme.PLAYREADY);\n  }\n\n  /**\n   * Sets the PlayReady playback.\n   * @param {Object} config - The shaka player config.\n   * @param {Array<Object>} drmData - The drm data.\n   * @returns {void}\n   */\n  static setDrmPlayback(config: Object, drmData: Array<Object>): void {\n    PlayReady._logger.debug('Sets drm playback');\n    let prDrmEntry = drmData.find(drmEntry => drmEntry.scheme === DrmScheme.PLAYREADY);\n    if (prDrmEntry) {\n      config.drm = {\n        servers: {\n          [DrmScheme.PLAYREADY]: prDrmEntry.licenseUrl\n        }\n      };\n    }\n  }\n};\n\nexport {PlayReady};\n","// @flow\nimport {IDrmProtocol, Env, DrmScheme, getLogger} from '@playkit-js/playkit-js';\n\nconst Widevine: IDrmProtocol = class Widevine {\n  static _logger = getLogger('Widevine');\n\n  /**\n   * Widevine is the configure key system.\n   * @param {Array<Object>} drmData - The drm data.\n   * @param {PKDrmConfigObject} drmConfig - The drm config.\n   * @return {boolean} - Whether Widevine is the configure key system.\n   */\n  static isConfigured(drmData: Array<Object>, drmConfig: PKDrmConfigObject): boolean {\n    return DrmScheme.WIDEVINE === drmConfig.keySystem && !!drmData.find(drmEntry => drmEntry.scheme === drmConfig.keySystem);\n  }\n\n  /**\n   * Widevine playback supports in case 2 conditions are met:\n   * 1. The environment supports Widevine playback.\n   * 2. The drm data of the source object contains entry with Widevine scheme.\n   * @param {Array<Object>} drmData - The drm data to check.\n   * @return {boolean} - Whether Widevine can be play on the current environment.\n   */\n  static canPlayDrm(drmData: Array<Object>): boolean {\n    Widevine._logger.debug('Can play DRM scheme of: ' + DrmScheme.WIDEVINE);\n    return !!drmData.find(drmEntry => drmEntry.scheme === DrmScheme.WIDEVINE);\n  }\n\n  /**\n   * Sets the Widevine playback.\n   * @param {Object} config - The shaka player config.\n   * @param {Array<Object>} drmData - The drm data.\n   * @returns {void}\n   */\n  static setDrmPlayback(config: Object, drmData: Array<Object>): void {\n    Widevine._logger.debug('Sets drm playback');\n    let browser = Env.browser.name;\n    let wwDrmEntry = drmData.find(drmEntry => drmEntry.scheme === DrmScheme.WIDEVINE);\n    if (wwDrmEntry) {\n      config.drm = {\n        servers: {\n          [DrmScheme.WIDEVINE]: wwDrmEntry.licenseUrl\n        },\n        advanced: {}\n      };\n      if (browser === 'Chrome') {\n        config.drm.advanced = {\n          [DrmScheme.WIDEVINE]: {\n            videoRobustness: 'SW_SECURE_CRYPTO',\n            audioRobustness: 'SW_SECURE_CRYPTO'\n          }\n        };\n      }\n    }\n  }\n};\n\nexport {Widevine};\n","// @flow\nimport {registerMediaSourceAdapter} from '@playkit-js/playkit-js';\nimport DashAdapter from './dash-adapter';\n\ndeclare var __VERSION__: string;\ndeclare var __NAME__: string;\n\nconst VERSION = __VERSION__;\nconst NAME = __NAME__;\n\nexport default DashAdapter;\nexport {VERSION, NAME};\n\n// Register DashAdapter to the media source adapter manager\nif (DashAdapter.isSupported()) {\n  registerMediaSourceAdapter(DashAdapter);\n}\n","// @flow\nimport {SegmentTemplate} from './segment-template';\nimport {Representation} from './representation';\nimport {MpdUtils, XmlUtils} from './parser-utils';\nimport {EssentialProperty} from './essential-property';\n\nclass AdaptationSet {\n  static ContentType: {[type: string]: string} = {\n    VIDEO: 'video',\n    AUDIO: 'audio',\n    TEXT: 'text',\n    IMAGE: 'image'\n  };\n\n  _id: string;\n  _mimeType: string;\n  _contentType: string;\n  _segmentTemplate: SegmentTemplate;\n  _essentialProperty: ?EssentialProperty;\n  _representations: Array<Representation>;\n\n  constructor(elem: HTMLElement) {\n    this._id = XmlUtils.parseAttr(elem, MpdUtils.AttributeTypes.ID);\n    this._mimeType = XmlUtils.parseAttr(elem, MpdUtils.AttributeTypes.MIME_TYPE);\n    this._contentType = XmlUtils.parseAttr(elem, MpdUtils.AttributeTypes.CONTENT_TYPE);\n    this._representations = Array.from(XmlUtils.findChildren(elem, MpdUtils.TagTypes.REPRESENTATION)).map(repElem => new Representation(repElem));\n    const segTempElem = XmlUtils.findChild(elem, MpdUtils.TagTypes.SEGMENT_TEMPLATE);\n    if (segTempElem) {\n      this._segmentTemplate = new SegmentTemplate(segTempElem);\n    }\n    const essPropElem = XmlUtils.findChild(elem, MpdUtils.TagTypes.ESSENTIAL_PROPERTY);\n    if (essPropElem) {\n      this._essentialProperty = new EssentialProperty(essPropElem);\n    }\n  }\n\n  get id(): string {\n    return this._id;\n  }\n\n  get mimeType(): string {\n    return this._mimeType;\n  }\n\n  get contentType(): string {\n    return this._contentType;\n  }\n\n  get segmentTemplate(): SegmentTemplate {\n    return this._segmentTemplate;\n  }\n\n  get essentialProperty(): ?EssentialProperty {\n    return this._essentialProperty;\n  }\n\n  get representations(): Array<Representation> {\n    return this._representations;\n  }\n}\n\nexport {AdaptationSet};\n","// @flow\nimport {MpdUtils, ParserUtils, XmlUtils} from './parser-utils';\nimport {AdaptationSet} from './adaptation-set';\nimport {getLogger} from '@playkit-js/playkit-js';\n\nclass DashManifestParser {\n  _logger: any = getLogger('DashManifestParser');\n  _xmlDoc: Document;\n  _adaptationSets: Array<AdaptationSet>;\n  _baseURL: ?string;\n\n  static isValid(): boolean {\n    return window.TextEncoder && window.TextDecoder;\n  }\n\n  constructor(manifest: ArrayBuffer | string) {\n    this._logger.debug('Initialize manifest parser');\n    this._adaptationSets = [];\n    let xmlStr;\n    if (manifest instanceof ArrayBuffer) {\n      xmlStr = ParserUtils.BufferToStr(manifest);\n    } else {\n      xmlStr = manifest;\n    }\n    if (xmlStr) {\n      this._xmlDoc = XmlUtils.parseXml(xmlStr);\n    }\n  }\n\n  parseManifest() {\n    try {\n      this._logger.debug('Start parsing dash manifest');\n      // For now parse only adaptation sets\n      this._parseAdaptionSets();\n      this._logger.debug('Manifest parsing finished successfully');\n    } catch (e) {\n      this._logger.warn('Manifest parsing failed', e);\n    }\n  }\n\n  // return the manifest BaseURL tag textvalue\n  getBaseUrl(): string {\n    return this._baseURL || '';\n  }\n\n  getImageSet(): ?AdaptationSet {\n    return this._adaptationSets.find((adaptationSet: AdaptationSet) => adaptationSet.contentType === AdaptationSet.ContentType.IMAGE);\n  }\n\n  hasImageSet(): boolean {\n    return !!this.getImageSet();\n  }\n\n  get adaptationSets(): Array<AdaptationSet> {\n    return this._adaptationSets;\n  }\n\n  _parseAdaptionSets = () => {\n    const baseURL = XmlUtils.findElements(this._xmlDoc, MpdUtils.TagTypes.BASE_URL);\n    if (baseURL && baseURL.length > 0) {\n      if (baseURL[0].innerHTML) {\n        this._baseURL = baseURL[0].textContent;\n      }\n    }\n    const adaptationNodes = XmlUtils.findElements(this._xmlDoc, MpdUtils.TagTypes.ADAPTATION_SET);\n    // For now parse only image adaptation sets\n    const imageAdaptationsNodes = Array.from(adaptationNodes).filter(\n      adaptation => XmlUtils.parseAttr(adaptation, MpdUtils.AttributeTypes.CONTENT_TYPE) === AdaptationSet.ContentType.IMAGE\n    );\n    if (imageAdaptationsNodes.length > 0) {\n      this._adaptationSets = imageAdaptationsNodes.map(adaptation => new AdaptationSet(adaptation));\n      this._logger.debug('Found image adaptation set', this._adaptationSets);\n    } else {\n      this._logger.debug('No image adaptations were found in manifest');\n    }\n  };\n}\n\nexport {DashManifestParser};\n","// @flow\nimport {MpdUtils, XmlUtils} from './parser-utils';\n\nclass EssentialProperty {\n  _schemeIdUri: string;\n  _value: string;\n\n  constructor(elem: HTMLElement) {\n    this._schemeIdUri = XmlUtils.parseAttr(elem, MpdUtils.AttributeTypes.SCHEME_ID_URI);\n    this._value = XmlUtils.parseAttr(elem, MpdUtils.AttributeTypes.VALUE);\n  }\n\n  get schemeIdUri(): string {\n    return this._schemeIdUri;\n  }\n\n  get value(): string {\n    return this._value;\n  }\n}\n\nexport {EssentialProperty};\n","// @flow\nimport {SegmentTemplate} from './segment-template';\n\nconst UrlUtils = {\n  resolve: (url: string, data: {id?: string, index?: number, bitrate?: number, time?: number}): string => {\n    const {id, index, bitrate, time} = data;\n    const regExp = /\\$([a-zA-Z]+)\\$/g;\n    const expressions = url.match(regExp);\n    const replaceTokens = (url: string, exp: string, token: any) => (token ? url.replace(exp, token) : url);\n    if (expressions) {\n      expressions.forEach((exp: string) => {\n        switch (exp) {\n          case SegmentTemplate.MediaTemplateType.REPRESENTATION:\n            url = replaceTokens(url, exp, id);\n            break;\n          case SegmentTemplate.MediaTemplateType.NUMBER:\n            url = replaceTokens(url, exp, index);\n            break;\n          case SegmentTemplate.MediaTemplateType.BANDWIDTH:\n            url = replaceTokens(url, exp, bitrate);\n            break;\n          case SegmentTemplate.MediaTemplateType.TIME:\n            url = replaceTokens(url, exp, time);\n            break;\n        }\n      });\n    }\n    return url;\n  }\n};\n\nconst ParserUtils = {\n  BufferToStr: (buffer: ArrayBuffer): ?string => {\n    if (TextDecoder) {\n      const textDecoder = new TextDecoder();\n      return textDecoder.decode(new Uint8Array(buffer));\n    }\n    return null;\n  },\n  StrToBuffer: (str: string): ?Uint8Array => {\n    if (TextEncoder) {\n      const textEncoder = new TextEncoder();\n      return textEncoder.encode(str);\n    }\n    return null;\n  }\n};\n\nconst MpdUtils = {\n  TagTypes: {\n    BASE_URL: 'BaseURL',\n    SEGMENT_TEMPLATE: 'SegmentTemplate',\n    REPRESENTATION: 'Representation',\n    ESSENTIAL_PROPERTY: 'EssentialProperty',\n    ADAPTATION_SET: 'AdaptationSet'\n  },\n  AttributeTypes: {\n    BASE_URL: 'BaseURL',\n    ID: 'id',\n    CONTENT_TYPE: 'contentType',\n    MIME_TYPE: 'mimeType',\n    MEDIA: 'media',\n    DURATION: 'duration',\n    START_NUMBER: 'startNumber',\n    TIMESCALE: 'timescale',\n    PRESENTATION_TIME_OFFSET: 'presentationTimeOffset',\n    END_NUMBER: 'endNumber',\n    BANDWIDTH: 'bandwidth',\n    WIDTH: 'width',\n    HEIGHT: 'height',\n    SCHEME_ID_URI: 'schemeIdUri',\n    VALUE: 'value'\n  }\n};\n\nconst XmlUtils = {\n  parseXml: (text: string): Document => {\n    const domParser = new DOMParser();\n    return domParser.parseFromString(text, 'text/xml');\n  },\n  parseAttr: (elem: HTMLElement, name: string, parseFunction?: Function, defaultValue: any): any => {\n    let parsedValue = null;\n    const value = elem.getAttribute(name);\n    if (value !== null) {\n      parsedValue = parseFunction ? parseFunction(value) : value;\n    }\n    return parsedValue == null ? defaultValue : parsedValue;\n  },\n  findElements: (node: HTMLElement, name: string): HTMLCollection<HTMLElement> => {\n    return node.getElementsByTagName(name);\n  },\n  findChild(elem: HTMLElement, name: string): ?HTMLElement {\n    const children = this.findChildren(elem, name);\n    if (children.length !== 1) {\n      return null;\n    }\n    return children[0];\n  },\n  findChildren: (elem: HTMLElement, name: string): Array<HTMLElement> => {\n    return Array.from(elem.childNodes).filter(child => {\n      return child instanceof Element && child.tagName === name;\n    });\n  },\n  parseInt: (intString: string): ?number => {\n    const n = Number(intString);\n    return n % 1 === 0 ? n : null;\n  },\n  parsePositiveInt: (intString: string): ?number => {\n    const n = Number(intString);\n    return n % 1 === 0 && n > 0 ? n : null;\n  },\n  parseFloat: (floatString: string): ?number => {\n    const n = Number(floatString);\n    return !isNaN(n) ? n : null;\n  }\n};\n\nexport {ParserUtils, MpdUtils, XmlUtils, UrlUtils};\n","// @flow\nimport {EssentialProperty} from './essential-property';\nimport {MpdUtils, XmlUtils} from './parser-utils';\n\nclass Representation {\n  _id: string;\n  _bandwidth: number;\n  _width: number;\n  _height: number;\n  _essentialProperty: ?EssentialProperty;\n\n  constructor(elem: HTMLElement) {\n    this._id = XmlUtils.parseAttr(elem, MpdUtils.AttributeTypes.ID);\n    this._bandwidth = XmlUtils.parseAttr(elem, MpdUtils.AttributeTypes.BANDWIDTH, parseInt);\n    this._width = XmlUtils.parseAttr(elem, MpdUtils.AttributeTypes.WIDTH, parseInt);\n    this._height = XmlUtils.parseAttr(elem, MpdUtils.AttributeTypes.HEIGHT, parseInt);\n    const essPropElem = XmlUtils.findChild(elem, MpdUtils.TagTypes.ESSENTIAL_PROPERTY);\n    if (essPropElem) {\n      this._essentialProperty = new EssentialProperty(essPropElem);\n    }\n  }\n\n  get bandwidth(): number {\n    return this._bandwidth;\n  }\n\n  get id(): string {\n    return this._id;\n  }\n\n  get width(): number {\n    return this._width;\n  }\n\n  get height(): number {\n    return this._height;\n  }\n\n  get essentialProperty(): ?EssentialProperty {\n    return this._essentialProperty;\n  }\n}\n\nexport {Representation};\n","// @flow\nimport {MpdUtils, XmlUtils} from './parser-utils';\n\nclass SegmentTemplate {\n  static MediaTemplateType: {[key: string]: string} = {\n    REPRESENTATION: '$RepresentationID$',\n    NUMBER: '$Number$',\n    BANDWIDTH: '$Bandwidth$',\n    TIME: '$Time$'\n  };\n\n  _media: string;\n  _duration: number;\n  _startNumber: number;\n  // Live related\n  _timescale: number;\n  _presentationTimeOffset: number;\n  _endNumber: number;\n\n  constructor(elem: HTMLElement) {\n    this._media = XmlUtils.parseAttr(elem, MpdUtils.AttributeTypes.MEDIA);\n    this._startNumber = XmlUtils.parseAttr(elem, MpdUtils.AttributeTypes.START_NUMBER, XmlUtils.parseInt, 1);\n    this._duration = XmlUtils.parseAttr(elem, MpdUtils.AttributeTypes.DURATION, XmlUtils.parseFloat);\n    this._timescale = XmlUtils.parseAttr(elem, MpdUtils.AttributeTypes.TIMESCALE, XmlUtils.parsePositiveInt, 1);\n    this._presentationTimeOffset = XmlUtils.parseAttr(elem, MpdUtils.AttributeTypes.PRESENTATION_TIME_OFFSET, XmlUtils.parseInt, 0);\n    this._endNumber = XmlUtils.parseAttr(elem, MpdUtils.AttributeTypes.END_NUMBER, XmlUtils.parsePositiveInt);\n  }\n\n  get media(): string {\n    return this._media;\n  }\n\n  get startNumber(): number {\n    return this._startNumber;\n  }\n\n  get duration(): number {\n    return this._duration;\n  }\n\n  get timescale(): number {\n    return this._timescale;\n  }\n\n  get presentationTimeOffset(): number {\n    return this._presentationTimeOffset;\n  }\n\n  get endNumber(): number {\n    return this._endNumber;\n  }\n}\n\nexport {SegmentTemplate};\n","module.exports = __WEBPACK_EXTERNAL_MODULE__playkit_js_playkit_js__;","module.exports = __WEBPACK_EXTERNAL_MODULE_shaka_player__;"],"sourceRoot":""}